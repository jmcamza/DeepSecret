# R script to download selected samples
# Copy code and run on a local machine to initiate download

library("rhdf5")    # can be installed using Bioconductor

destination_file = "human_matrix_v10.h5"
extracted_expression_file = "HCT116_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix_v10.h5"

# Check if gene expression file was already downloaded, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE, mode = 'wb')
}

# Selected samples to be extracted
samp = c("GSM1241249","GSM1241140","GSM1241225","GSM1241162","GSM1151059","GSM1241138","GSM1241228","GSM1241166","GSM1241164","GSM1241145","GSM1241167","GSM1241146","GSM1241148","GSM1241193","GSM1241196","GSM1241212","GSM1241242","GSM1241159","GSM1241224","GSM1241218","GSM1241180","GSM1241221","GSM1241204","GSM1241241","GSM1241233","GSM1241198","GSM1241215","GSM1241187","GSM1241236","GSM1241176","GSM1241169",
"GSM1241203","GSM1241229","GSM1241172","GSM1241205","GSM1241209","GSM1241226","GSM1241208","GSM1241248","GSM1241142","GSM1241175","GSM1151055","GSM1241192","GSM1241152","GSM1241207","GSM1241158","GSM1162758","GSM1241137","GSM1241160","GSM1241201","GSM1241246","GSM1241179","GSM1241143","GSM1241161","GSM1241234","GSM1162759","GSM1162757","GSM1241139","GSM1241195","GSM1241178","GSM1241165",
"GSM1241188","GSM1241156","GSM1241220","GSM1241200","GSM1241155","GSM1241186","GSM1241206","GSM1241184","GSM1241194","GSM1241232","GSM1241245","GSM1241151","GSM1241216","GSM1241243","GSM1241154","GSM1151054","GSM1241144","GSM1241227","GSM1241168","GSM1241230","GSM1241157","GSM1241163","GSM1241189","GSM1241182","GSM1241214","GSM1241202","GSM1241190","GSM1241217","GSM1241174","GSM1241237",
"GSM1241210","GSM1241197","GSM1241185","GSM1241199","GSM1241244","GSM1241153","GSM1241141","GSM1241147","GSM1241211","GSM1241183","GSM1241219","GSM1241171","GSM1241240","GSM1241238","GSM1241235","GSM1241247","GSM1241150","GSM1151058","GSM1241213","GSM1241170","GSM1241191","GSM1241181","GSM1241149","GSM1241239","GSM1241231","GSM2157838","GSM1960351","GSM1382045","GSM1400923","GSM1382043",
"GSM1537512","GSM1412747","GSM1890699","GSM1960349","GSM1727128","GSM1400921","GSM1960338","GSM1412748","GSM1382041","GSM1890694","GSM1400918","GSM1890680","GSM1400922","GSM1960342","GSM1960350","GSM1400916","GSM1586020","GSM1382048","GSM1847263","GSM2297324","GSM1960347","GSM2157837","GSM1727129","GSM1890679","GSM1960344","GSM1537515","GSM1382042","GSM1727127","GSM1537513","GSM1890682",
"GSM1382046","GSM2297327","GSM1960352","GSM1400919","GSM1412745","GSM1537514","GSM1960346","GSM1890683","GSM1960343","GSM1960345","GSM2297325","GSM1890696","GSM1847265","GSM1400917","GSM1960348","GSM2297326","GSM1382047","GSM1890676","GSM1586022","GSM1890698","GSM1586024","GSM1960340","GSM1960339","GSM1890678","GSM1890695","GSM1960337","GSM1847266","GSM1960341","GSM1586025","GSM1382044",
"GSM1890697","GSM1847264","GSM1266734","GSM1586023","GSM1890681","GSM1890677","GSM1586021","GSM1412746","GSM1855853","GSM1945886","GSM2042806","GSM1500847","GSM1658689","GSM1658683","GSM2071740","GSM1658684","GSM1855851","GSM1658686","GSM1500852","GSM1658687","GSM1898652","GSM1658682","GSM2071737","GSM2042805","GSM1945883","GSM1658681","GSM1658685","GSM1855852","GSM1500849","GSM1500851",
"GSM1945888","GSM2122815","GSM2071736","GSM2122814","GSM2042807","GSM1658688","GSM1945887","GSM2071738","GSM1855854","GSM2071741","GSM1500850","GSM2071739","GSM1945884","GSM2042804","GSM1500848","GSM1898651","GSM1945885","GSM1266733","GSM1400920","GSM1727126","GSM1836004","GSM1836002","GSM1836000","GSM1836001","GSM1836005","GSM1836003","GSM1890684","GSM1960336","GSM2157836","GSM2089690",
"GSM2089689","GSM2089691","GSM2089687","GSM2089692","GSM2089688","GSM2144412","GSM2481443","GSM2481442","GSM2481444","GSM2481441","GSM2481446","GSM2481445","GSM2481439","GSM2481440","GSM1325490","GSM1325491","GSM1325492","GSM2680444","GSM2680445","GSM2680446","GSM2680447","GSM2680448","GSM2680449","GSM2680462","GSM2680463","GSM2680464","GSM2680465","GSM2680466","GSM2680467","GSM2680468",
"GSM2680469","GSM2680470","GSM2680471","GSM2680472","GSM2680473","GSM2712773","GSM2712774","GSM2712775","GSM2712776","GSM2712777","GSM2712778","GSM2712779","GSM2712780","GSM2712781","GSM2296620","GSM2296622","GSM2296625","GSM2296633","GSM2474241","GSM2474242","GSM2474243","GSM2474244","GSM2474245","GSM2474246","GSM2474247","GSM2474248","GSM2515724","GSM2515725","GSM2515726","GSM2515727",
"GSM2515728","GSM2515729","GSM2515730","GSM2515731","GSM2527757","GSM2527758","GSM2527759","GSM2527760","GSM2527761","GSM2527762","GSM2527763","GSM2527764","GSM2664062","GSM2664063","GSM2664064","GSM2664065","GSM2664066","GSM2664067","GSM2664068","GSM2664069","GSM2664070","GSM2664071","GSM2664072","GSM2664073","GSM2664074","GSM2664075","GSM2664076","GSM2664077","GSM2664078","GSM2664079",
"GSM2664080","GSM2664081","GSM2664082","GSM2664083","GSM2664084","GSM2664085","GSM2719768","GSM2719769","GSM2719770","GSM2719771","GSM2719772","GSM2719773","GSM2719774","GSM2719775","GSM2414773","GSM2775143","GSM2775144","GSM2775145","GSM2775146","GSM2927904","GSM2927905","GSM2927906","GSM2927907","GSM2927908","GSM2927909","GSM1700948","GSM1700949","GSM1700950","GSM1700951","GSM1866986",
"GSM1866987","GSM1866988","GSM1866989","GSM1866990","GSM1866991","GSM1866992","GSM1866993","GSM1866994","GSM1866995","GSM1866996","GSM1866997","GSM1866998","GSM1866999","GSM1867000","GSM1867004","GSM1867005","GSM1867006","GSM1867007","GSM1867008","GSM1867009","GSM1867010","GSM1944750","GSM2042809","GSM2042810","GSM2042811","GSM2042812","GSM2060279","GSM2060280","GSM2060281","GSM2060282",
"GSM2060283","GSM2060284","GSM2060285","GSM2060286","GSM2060287","GSM2060288","GSM2060289","GSM2060290","GSM2175547","GSM2175548","GSM2175549","GSM2175550","GSM2175551","GSM2175552","GSM2175553","GSM2175554","GSM2175568","GSM2175569","GSM2175570","GSM2175584","GSM2175585","GSM2175586","GSM2358949","GSM2358950","GSM2358951","GSM2358952","GSM2358953","GSM2358954","GSM2358955","GSM2358956",
"GSM2358957","GSM2358958","GSM2358959","GSM2358960","GSM2393844","GSM2393845","GSM2393846","GSM2393847","GSM2393848","GSM2393849","GSM2393850","GSM2393851","GSM2393852","GSM2393853","GSM2393854","GSM2393855","GSM2393862","GSM2393863","GSM2393864","GSM2393865","GSM2393866","GSM2393867","GSM2393868","GSM2393869","GSM2393870","GSM2393871","GSM2393872","GSM2393873","GSM2571064","GSM2571065",
"GSM2571066","GSM2571067","GSM2571068","GSM2571069","GSM2571070","GSM2571071","GSM2571072","GSM2571073","GSM2571074","GSM2571075","GSM2571076","GSM2571077","GSM2571078","GSM2571079","GSM2571080","GSM2571081","GSM2571082","GSM2571083","GSM2571084","GSM2571085","GSM2571086","GSM2571087","GSM2571088","GSM2571089","GSM2571090","GSM2571091","GSM2571092","GSM2571093","GSM2571094","GSM2571095",
"GSM2571096","GSM2571097","GSM2571098","GSM2571099","GSM2667966","GSM2667967","GSM2667968","GSM2667969","GSM2667970","GSM2667971","GSM2667972","GSM2667973","GSM2667974","GSM2667975","GSM2667976","GSM2667977","GSM2667978","GSM2667979","GSM2667980","GSM2667981","GSM2667982","GSM2667983","GSM2667984","GSM2667985","GSM2711144","GSM2711145","GSM2711146","GSM2711147","GSM2711148","GSM2711149",
"GSM2711150","GSM2711151","GSM2711152","GSM2711153","GSM2711154","GSM2711155","GSM2711403","GSM2711404","GSM2711405","GSM3025557","GSM3025558","GSM3025559","GSM3025560","GSM3025561","GSM2803993","GSM2803994","GSM2803995","GSM2803996","GSM2891824","GSM2891825","GSM2891838","GSM2891839","GSM2891840","GSM2891841","GSM2891842","GSM2891843","GSM2891844","GSM2891845","GSM2891846","GSM2891847",
"GSM2891848","GSM2891849","GSM2891850","GSM2891851","GSM2891852","GSM2891853","GSM2671001","GSM2671002","GSM2671003","GSM2671004","GSM2671005","GSM2671006","GSM2857621","GSM2857622","GSM2677396","GSM2677408","GSM3208726","GSM3208727","GSM3208728","GSM3208729","GSM3208730","GSM3208731","GSM3208732","GSM3208733","GSM3208734","GSM3208735","GSM3208736","GSM3208737","GSM3145581","GSM3145582",
"GSM3145583","GSM2152261","GSM2837295","GSM2837296","GSM2808867","GSM2808868","GSM2808869","GSM2808870","GSM2808871","GSM2808872","GSM2808873","GSM2808874","GSM3403542","GSM3403543","GSM3403544","GSM3403545","GSM3403546","GSM3403547","GSM3403548","GSM3403549","GSM2916051","GSM2916052","GSM2916053","GSM2916054","GSM2916055","GSM2916056","GSM2916057","GSM2916058","GSM2916059","GSM2916060",
"GSM2916061","GSM2916062","GSM2190717","GSM2190718","GSM3593897","GSM3768070","GSM3768071","GSM3768072","GSM3768073","GSM3768074","GSM3768075","GSM3768076","GSM3768077","GSM3768078","GSM3177424","GSM3177425","GSM3177426","GSM3177427","GSM3177428","GSM3177429","GSM3177430","GSM3177431","GSM3177432","GSM3177433","GSM3177434","GSM3177435","GSM3523610","GSM3523611","GSM3523612","GSM3523613",
"GSM3523614","GSM3523615","GSM3523616","GSM3523617","GSM3523618","GSM3523619","GSM3523620","GSM3523621","GSM3523622","GSM3523623","GSM3523624","GSM3523625","GSM3523626","GSM3523627","GSM3523628","GSM3523629","GSM3523630","GSM3523631","GSM3523632","GSM3523633","GSM3657661","GSM3657662","GSM3657663","GSM3657664","GSM3657665","GSM3657666","GSM3657667","GSM3657668","GSM3657669","GSM3657670",
"GSM3657671","GSM3657672","GSM3657673","GSM3657674","GSM3895268","GSM3895269","GSM3895270","GSM3895271","GSM3895272","GSM3895273","GSM3895274","GSM3895275","GSM3895276","GSM3895277","GSM3895278","GSM3895279","GSM3895280","GSM3895281","GSM3685664","GSM3685665","GSM3685666","GSM3685667","GSM3685668","GSM3685669","GSM3685670","GSM3685671","GSM3685672","GSM3685673","GSM3685674","GSM3685675",
"GSM3392922","GSM3392923","GSM3392924","GSM3392925","GSM3392926","GSM3392927","GSM3392928","GSM3392929","GSM3392930","GSM3392931","GSM3392932","GSM3392933","GSM2817877","GSM2817878","GSM2817879","GSM2817880","GSM2817881","GSM2817882","GSM2817883","GSM2817884","GSM2817885","GSM2817886","GSM2817887","GSM2817888","GSM2817889","GSM2817890","GSM2817891","GSM2817892","GSM2817893","GSM2817894",
"GSM3763022","GSM3763023","GSM3763024","GSM3763025","GSM3763026","GSM3763027","GSM3763028","GSM3763029","GSM3763030","GSM3763031","GSM3763032","GSM3763033","GSM3763034","GSM3763035","GSM3763036","GSM3834402","GSM3834403","GSM3834404","GSM3834405","GSM3834406","GSM3834407","GSM1413016","GSM1413017","GSM1413018","GSM1413019","GSM1413020","GSM1413021","GSM1413022","GSM1413023","GSM1413024",
"GSM1413025","GSM1413026","GSM1413027","GSM1413028","GSM1413030","GSM1413031","GSM2774580","GSM2774581","GSM2774582","GSM2774583","GSM2877961","GSM2877962","GSM2877963","GSM2877964","GSM2877965","GSM2877966","GSM2877967","GSM2877968","GSM2877969","GSM2877970","GSM2877971","GSM2877972","GSM2877973","GSM2877974","GSM2877975","GSM3317792","GSM3317793","GSM3317794","GSM3317795","GSM3317797",
"GSM3356654","GSM3356655","GSM3356656","GSM3356657","GSM3356658","GSM3684373","GSM3684374","GSM3684375","GSM3684376","GSM3684377","GSM3684378","GSM3684380","GSM3684381","GSM3684382","GSM3684383","GSM3684384","GSM3685744","GSM3685745","GSM3729267","GSM3729268","GSM3729269","GSM3729270","GSM3729271","GSM3729272","GSM3775855","GSM3775856","GSM3775857","GSM3775858","GSM3775859","GSM3775860",
"GSM3775861","GSM3775862","GSM3775863","GSM3775864","GSM3775865","GSM3775866","GSM3775867","GSM3775868","GSM3775869","GSM3775870","GSM3775871","GSM3775872","GSM3775873","GSM3775874","GSM3775875","GSM3775876","GSM3775877","GSM3775878","GSM3898426","GSM3898427","GSM3898428","GSM3898429","GSM3898430","GSM3898431","GSM3898432","GSM3898433","GSM3948500","GSM3948501","GSM4005526","GSM4005527",
"GSM4005528","GSM4005529","GSM4010647","GSM4010648","GSM4010649","GSM4010650","GSM4010651","GSM4010652","GSM4010653","GSM4010654","GSM4085996","GSM4085998","GSM4085999","GSM4086000","GSM4086001","GSM4086002","GSM4086003","GSM4108022","GSM4108023","GSM4108024","GSM4108026","GSM4108027","GSM4108028","GSM4108029","GSM4136503","GSM4136504","GSM4136505","GSM4136506","GSM4261657","GSM4261658",
"GSM4261659","GSM4261660","GSM4261661","GSM4261662","GSM4261663","GSM4261664","GSM4261665","GSM4261666","GSM4261667","GSM4261668","GSM4282356","GSM4282357","GSM4282358","GSM4282359","GSM4286761","GSM4286763","GSM4286765","GSM4286766","GSM4286771","GSM4286772","GSM4286773","GSM4286774","GSM4286776","GSM4301262","GSM4301263","GSM4301264","GSM4301265","GSM4301266","GSM4301267","GSM4404081",
"GSM4404082","GSM4404083","GSM4404084","GSM4404085","GSM4404086","GSM4404087","GSM4404088","GSM4404089","GSM4404090","GSM4404091","GSM4404092","GSM4404093","GSM4404094","GSM4404095","GSM4404096","GSM4404097","GSM4404098","GSM4404099","GSM4404100","GSM4404101","GSM4404102","GSM4404103","GSM4436405","GSM4436406","GSM4436407","GSM4436408","GSM4436409","GSM4436410","GSM4551665","GSM4551666",
"GSM4551667","GSM4551668","GSM4551669","GSM4551670","GSM4551671","GSM4551672","GSM4684605","GSM4684606","GSM4684607","GSM4684608","GSM4684609","GSM4684610","GSM4704828","GSM4704829","GSM4704831","GSM4704832","GSM4704833","GSM1413029","GSM2787773","GSM2787774","GSM3317796","GSM3431175","GSM3431176","GSM3440232","GSM3440233","GSM3440234","GSM3440235","GSM3440236","GSM3440237","GSM3972384",
"GSM3972385","GSM3972386","GSM3972387","GSM4036934","GSM4036935","GSM4036936","GSM4036937","GSM4036938","GSM4036939","GSM4036940","GSM4036941","GSM4036942","GSM4036943","GSM4036944","GSM4036945","GSM4036946","GSM4036947","GSM4036948","GSM4036949","GSM4036950","GSM4036951","GSM4036952","GSM4036953","GSM4072173","GSM4072174","GSM4072175","GSM4072176","GSM4072177","GSM4085997","GSM4108025",
"GSM4113853","GSM4113854","GSM4113855","GSM4113856","GSM4113857","GSM4113858","GSM4113859","GSM4113860","GSM4113861","GSM4113862","GSM4113863","GSM4113864","GSM4227290","GSM4227292","GSM4227293","GSM4227294","GSM4227295","GSM4227296","GSM4227297","GSM4227298","GSM4227299","GSM4227300","GSM4227301","GSM4286775","GSM4426221","GSM4426222","GSM4426223","GSM4426224","GSM4426225","GSM4426226",
"GSM4426227","GSM4426228","GSM4426229","GSM4671055","GSM4671056","GSM4671057","GSM4671058","GSM4671059","GSM4671060","GSM4671061","GSM4671062","GSM4704830","GSM4727058","GSM4727059","GSM4727060","GSM4727061","GSM4727062","GSM4727063","GSM4751865","GSM4751866","GSM4751867","GSM4751868","GSM4751869","GSM4751870","GSM4751871","GSM4751872","GSM4800644","GSM4800646","GSM4800647","GSM4800648",
"GSM4800649","GSM4805399","GSM4805400","GSM4805401","GSM4805402","GSM4805403","GSM4805404","GSM4805405","GSM4805406","GSM4805407","GSM4805408","GSM4813827","GSM4813829","GSM4813830","GSM4813831","GSM4813832","GSM4813833","GSM4813834","GSM4813835","GSM4813836","GSM4813837","GSM4813838","GSM4891239","GSM4891244","GSM4950467","GSM4950468","GSM4950469","GSM4950470","GSM4950471","GSM4950472",
"GSM4950473","GSM4950474","GSM4950475","GSM4950476","GSM4950477","GSM4950478","GSM4950479","GSM4950480","GSM4950481","GSM4950482","GSM4950483","GSM4950485","GSM4950486","GSM3057142","GSM3057143","GSM3057144","GSM3057145","GSM3057146","GSM3057147","GSM3427844","GSM3427845","GSM3427846","GSM3427847","GSM3427848","GSM3427849","GSM3427850","GSM3427851","GSM3560679","GSM3560680","GSM3593876",
"GSM3593877","GSM3593878","GSM3593879","GSM3593880","GSM3593881","GSM3593882","GSM3593883","GSM3593884","GSM3593885","GSM3593886","GSM3593887","GSM3593888","GSM3593889","GSM3593890","GSM3593891","GSM3593892","GSM3593893","GSM3593894","GSM3593895","GSM3593896","GSM3791401","GSM3791402","GSM3791403","GSM3791404","GSM4117288","GSM4117290","GSM4213584","GSM4213585","GSM4213587","GSM4213588",
"GSM4213589","GSM4317760","GSM4317762","GSM4500981","GSM4500982","GSM4500983","GSM4500984","GSM4500985","GSM4500986","GSM4563468","GSM4563469","GSM4563470","GSM4563471","GSM4563472","GSM4563473","GSM4563474","GSM4563475","GSM4563476","GSM4563477","GSM4563478","GSM4563479","GSM4563480","GSM4563481","GSM4563482","GSM4563483","GSM4563484","GSM4563485","GSM4563486","GSM4563488","GSM4563489",
"GSM4563490","GSM4563491","GSM4563492","GSM4563493","GSM4563494","GSM4563495","GSM4563496","GSM4563497","GSM4563498","GSM4563499","GSM4563500","GSM4563501","GSM4563502","GSM4563503","GSM4563504","GSM4563505","GSM4563506","GSM4563507","GSM4563508","GSM4563509","GSM4563510","GSM4563511","GSM4563512","GSM4563513","GSM4563514","GSM4563515","GSM4563516","GSM4563517","GSM4563518","GSM4563519",
"GSM4563520","GSM4563521","GSM4563522","GSM4563523","GSM4563524","GSM4563525","GSM4563526","GSM4563527","GSM4563529","GSM4563530","GSM4563531","GSM4563532","GSM4563533","GSM4563534","GSM4563535","GSM4563536","GSM4563537","GSM4563538","GSM4563539","GSM4563540","GSM4563541","GSM4563542","GSM4563543","GSM4563544","GSM4563545","GSM4563546","GSM4563547","GSM4563548","GSM4563549","GSM4563550",
"GSM4563551","GSM4563552","GSM4563553","GSM4563554","GSM4563555","GSM4563556","GSM4563557","GSM4563558","GSM4563559","GSM4563560","GSM4563561","GSM4563562","GSM4563563","GSM4563564","GSM4563565","GSM4563566","GSM4563567","GSM4563568","GSM4563569","GSM4563570","GSM4563571","GSM4563572","GSM4563573","GSM4563575","GSM4563576","GSM4563577","GSM4563578","GSM4563579","GSM4563580","GSM4563581",
"GSM4563582","GSM4563583","GSM4563584","GSM4563586","GSM4563587","GSM4563588","GSM4563589","GSM4563590","GSM4563591","GSM4563592","GSM4563593","GSM4563594","GSM4563595","GSM4563596","GSM4563597","GSM4563598","GSM4563599","GSM4563600","GSM4563601","GSM4563602","GSM4563603","GSM4563604","GSM4563605","GSM4563606","GSM4563607","GSM4563608","GSM4563609","GSM4563610","GSM4563611","GSM4563612",
"GSM4563613","GSM4563614","GSM4563615","GSM4563616","GSM4563617","GSM4563618","GSM4563619","GSM4563620","GSM4563621","GSM4563622","GSM4563623","GSM4563624","GSM4563625","GSM4563626","GSM4563627","GSM4563628","GSM4563629","GSM4563630","GSM4563631","GSM4563632","GSM4563633","GSM4563634","GSM4563635","GSM4563637","GSM4563638","GSM4563639","GSM4563640","GSM4563641","GSM4563642","GSM4563643",
"GSM4563644","GSM4563645","GSM4563646","GSM4563647","GSM4563648","GSM4563649","GSM4563650","GSM4563651","GSM4563652","GSM4563653","GSM4563654","GSM4630503","GSM4630504","GSM4630505","GSM4630506","GSM4630507","GSM4630509","GSM4630511","GSM4630512","GSM4630513","GSM4630514","GSM4630515","GSM4630516","GSM4630517","GSM4630518","GSM4630519","GSM4630520","GSM4630522","GSM4630523","GSM4663503",
"GSM4663504","GSM4663505","GSM4663506","GSM4663507","GSM4663509","GSM4663511","GSM4663512","GSM4663513","GSM4663514","GSM4663515","GSM4663517","GSM4663518","GSM4664617","GSM4664618","GSM4664619","GSM4664620","GSM4664621","GSM4664622","GSM4664627","GSM4680470","GSM4680471","GSM4680472","GSM4680473","GSM4680474","GSM4680476","GSM4680477","GSM4697820","GSM4697823","GSM4779275","GSM4779276",
"GSM4779277","GSM4779278","GSM4779279","GSM4779280","GSM4820773","GSM4820774","GSM4820775","GSM4820776","GSM4827148","GSM4827149","GSM4875354","GSM4875393","GSM4875397","GSM4943703","GSM4943704","GSM4943705","GSM4943706","GSM4943707","GSM4943708","GSM4943709","GSM4943710","GSM4943711","GSM4943712","GSM4943713","GSM4943714","GSM4959019","GSM4959020","GSM4959021","GSM4959026","GSM4959028",
"GSM4959029","GSM4962509","GSM4962510","GSM4962511","GSM4962512","GSM4962513","GSM4962518","GSM4962521","GSM5046672","GSM5046673","GSM5046674","GSM5046677","GSM5046678","GSM5046679","GSM5046680","GSM5046681","GSM5048996","GSM5048997","GSM5048998","GSM5048999","GSM5049000","GSM5049001","GSM5049002","GSM5049003","GSM5049006","GSM5049008","GSM5049009","GSM5049010","GSM5049011","GSM5049012",
"GSM5049013","GSM5074350","GSM5074351","GSM5074352","GSM5074353","GSM5243234","GSM5243235","GSM5243236","GSM5243237","GSM5243238","GSM5243239","GSM5243240","GSM5243241","GSM5243242","GSM5243243","GSM5243244","GSM5243245","GSM5243246","GSM5243247","GSM5264585","GSM5264588","GSM5264590","GSM5264592","GSM5264593","GSM5264595","GSM5264597","GSM5264598","GSM5264599","GSM5282919","GSM5282920",
"GSM5282923","GSM5282926","GSM5330783","GSM5370896","GSM5370897","GSM5370898","GSM5370901","GSM5444446","GSM5444447","GSM5463588","GSM5463589","GSM5463591","GSM5463592","GSM5463593","GSM5463594","GSM5463596","GSM5463597","GSM5463598","GSM5463599","GSM5463600","GSM5463601","GSM5463602","GSM5463603","GSM5463604","GSM5463605","GSM5463606","GSM5463607","GSM5463608","GSM5463609","GSM5463610",
"GSM5463611","GSM5463612","GSM5463613","GSM5463615","GSM5463616","GSM5463617","GSM5463618","GSM5463620","GSM5463621","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/samples/geo_accession")
genes = h5read(destination_file, "meta/genes/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = t(h5read(destination_file, "data/expression", index=list(sample_locations, 1:length(genes))))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE, col.names=NA)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))

