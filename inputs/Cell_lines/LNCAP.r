# R script to download selected samples
# Copy code and run on a local machine to initiate download

library("rhdf5")    # can be installed using Bioconductor

destination_file = "human_matrix_v10.h5"
extracted_expression_file = "LNCAP_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix_v10.h5"

# Check if gene expression file was already downloaded, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE, mode = 'wb')
}

# Selected samples to be extracted
samp = c("GSM1159902","GSM1154037","GSM941198","GSM1071279","GSM1185147","GSM1159897","GSM1185137","GSM1071278","GSM1159900","GSM1071283","GSM1159898","GSM1159895","GSM941199","GSM1185138","GSM1185148","GSM941196","GSM1185139","GSM1159903","GSM1159901","GSM1071282","GSM1159904","GSM1185145","GSM1185142","GSM1154038","GSM1185144","GSM1185141","GSM1185140","GSM1159896","GSM1185146","GSM1159899","GSM1185143",
"GSM941211","GSM1359239","GSM1348226","GSM1359237","GSM1864234","GSM1348228","GSM1864237","GSM1573661","GSM1864215","GSM1359238","GSM1550724","GSM2091091","GSM1864217","GSM1864216","GSM1864214","GSM1573660","GSM1864232","GSM1573658","GSM1363032","GSM1348229","GSM1864229","GSM1864227","GSM1573663","GSM1864222","GSM1864218","GSM1363031","GSM1550723","GSM1864213","GSM1573662","GSM1328161",
"GSM1550725","GSM1550726","GSM1348227","GSM1864225","GSM1550727","GSM1864219","GSM1864220","GSM1328162","GSM1550728","GSM1538436","GSM1832741","GSM1902622","GSM1902623","GSM1832740","GSM1832736","GSM1832737","GSM1538435","GSM1538437","GSM1902621","GSM1832738","GSM1832739","GSM1573659","GSM1933882","GSM1933873","GSM1933865","GSM1933878","GSM1933868","GSM1933880","GSM1933861","GSM1933879",
"GSM1933867","GSM1933864","GSM1933869","GSM1933863","GSM1933874","GSM1933883","GSM1933866","GSM1933862","GSM1933877","GSM1933876","GSM1933881","GSM1933859","GSM1933871","GSM1933870","GSM1933860","GSM1933875","GSM1933872","GSM2091092","GSM2432773","GSM2432771","GSM2432769","GSM2432783","GSM2432781","GSM2432775","GSM1941105","GSM1941109","GSM1941106","GSM1941108","GSM1941107","GSM1941104",
"GSM2060176","GSM2060169","GSM2060177","GSM2060173","GSM2060174","GSM2060180","GSM2060168","GSM2060181","GSM2060182","GSM2060171","GSM2060167","GSM2060172","GSM2060170","GSM2060178","GSM2060179","GSM2060175","GSM2361407","GSM2361408","GSM2361406","GSM2361405","GSM2277137","GSM2277139","GSM2277140","GSM2277141","GSM2277142","GSM2277143","GSM2277144","GSM2277145","GSM2277146","GSM2277147",
"GSM2643285","GSM2643286","GSM2643287","GSM2643288","GSM2643289","GSM2643290","GSM2643291","GSM2643292","GSM2734294","GSM2734295","GSM2734296","GSM2734297","GSM2788088","GSM2788089","GSM2788090","GSM2788091","GSM2788092","GSM2788093","GSM2127611","GSM2127612","GSM2127613","GSM2127614","GSM2127615","GSM2127616","GSM2486644","GSM2486645","GSM2486646","GSM2486647","GSM2486648","GSM2486649",
"GSM2565463","GSM2565464","GSM2565465","GSM2565466","GSM2565467","GSM2565468","GSM2565469","GSM2565470","GSM2565471","GSM2565472","GSM2565473","GSM2565474","GSM2565475","GSM2565476","GSM2565477","GSM2565478","GSM2565479","GSM2565480","GSM2565481","GSM2565482","GSM2565483","GSM2565484","GSM2565485","GSM2565486","GSM2565487","GSM2565488","GSM2565489","GSM2565490","GSM2565491","GSM2565492",
"GSM2565493","GSM2565494","GSM2565495","GSM2565496","GSM2565497","GSM2565498","GSM2565499","GSM2565500","GSM2565501","GSM2565502","GSM2565503","GSM2565504","GSM2565505","GSM2565506","GSM2565507","GSM2565508","GSM2565509","GSM2565510","GSM2565511","GSM2565512","GSM2565513","GSM2565514","GSM2565515","GSM2565516","GSM2565517","GSM2565518","GSM2565519","GSM2565520","GSM2565521","GSM2565522",
"GSM2565523","GSM2565524","GSM2565525","GSM2565526","GSM2565527","GSM2565528","GSM2565529","GSM2565530","GSM2565531","GSM2565532","GSM2565533","GSM2565534","GSM2565535","GSM2565536","GSM2565537","GSM2565538","GSM2565539","GSM2565540","GSM2565541","GSM2565542","GSM2565543","GSM2565544","GSM2565545","GSM2565546","GSM2565547","GSM2565548","GSM2565549","GSM2565550","GSM2565551","GSM2565552",
"GSM2565553","GSM2565554","GSM2565555","GSM2565556","GSM2565557","GSM2565558","GSM2565559","GSM2565560","GSM2565561","GSM2565562","GSM2565563","GSM2565564","GSM2565565","GSM2565566","GSM2565567","GSM2565568","GSM2565569","GSM2565570","GSM2565571","GSM2565572","GSM2565573","GSM2565574","GSM2565575","GSM2565576","GSM2565577","GSM2565578","GSM2565579","GSM2565580","GSM2565581","GSM2565582",
"GSM2565583","GSM2565584","GSM2565585","GSM2565586","GSM2565587","GSM2565588","GSM2565589","GSM2565590","GSM2565591","GSM2565592","GSM2565593","GSM2565594","GSM2565595","GSM2565596","GSM2565598","GSM2565600","GSM2565601","GSM2565602","GSM2565603","GSM2565604","GSM2565605","GSM2565606","GSM2565607","GSM2565608","GSM2565609","GSM2565610","GSM2565612","GSM2565613","GSM2565614","GSM2565616",
"GSM2565617","GSM2565618","GSM2565619","GSM2565620","GSM2565621","GSM2565622","GSM2565623","GSM2565624","GSM2565625","GSM2565626","GSM2565627","GSM2565628","GSM2565629","GSM2565630","GSM2565631","GSM2565632","GSM2565633","GSM2565634","GSM2565635","GSM2565636","GSM2565637","GSM2565638","GSM2565639","GSM2565640","GSM2565641","GSM2565642","GSM2565643","GSM2565644","GSM2565645","GSM2565646",
"GSM2565647","GSM2565648","GSM2565649","GSM2565650","GSM2565651","GSM2565652","GSM2565653","GSM2565654","GSM2753415","GSM2753416","GSM2753417","GSM2817823","GSM2817824","GSM2817825","GSM2817826","GSM2817827","GSM2817828","GSM2817832","GSM2817833","GSM2817834","GSM2817835","GSM2817836","GSM2817837","GSM3018523","GSM3018524","GSM3018525","GSM3018526","GSM2652441","GSM2652442","GSM2652443",
"GSM2652444","GSM2652445","GSM2652446","GSM2652447","GSM2652448","GSM2652449","GSM2652450","GSM2652451","GSM2652452","GSM2652453","GSM2652454","GSM2652455","GSM2652456","GSM2652457","GSM2652458","GSM2652459","GSM2652460","GSM2652461","GSM2652462","GSM2652463","GSM2652464","GSM2652465","GSM2652466","GSM2652467","GSM2652468","GSM2652469","GSM2652470","GSM2652471","GSM2652472","GSM2652473",
"GSM2652474","GSM2652475","GSM2652476","GSM2652477","GSM2652478","GSM2652479","GSM2652480","GSM2652481","GSM2652482","GSM2652483","GSM2652484","GSM2652485","GSM2652486","GSM2652487","GSM2652488","GSM2652489","GSM2652490","GSM2652491","GSM2652492","GSM2652493","GSM2652494","GSM2652495","GSM2652496","GSM2652497","GSM2652498","GSM2652499","GSM2652500","GSM2652501","GSM2652502","GSM2652503",
"GSM2652504","GSM2652505","GSM2652506","GSM2652507","GSM2652508","GSM2652509","GSM2652510","GSM2652511","GSM2652512","GSM2652513","GSM2652514","GSM2652515","GSM2652516","GSM2652517","GSM2652518","GSM2652519","GSM2652520","GSM2652521","GSM2652522","GSM2652523","GSM2652524","GSM2652525","GSM2652526","GSM2652527","GSM2652528","GSM2652529","GSM2652530","GSM2652531","GSM2652532","GSM2652533",
"GSM2652534","GSM2652535","GSM2652536","GSM2652537","GSM2652538","GSM2652539","GSM2652540","GSM2652541","GSM2652542","GSM2652543","GSM2652544","GSM2652545","GSM2652546","GSM2652547","GSM2652548","GSM2652549","GSM2652550","GSM2652551","GSM2652552","GSM2652553","GSM2652554","GSM2652555","GSM2652556","GSM2652557","GSM2652558","GSM2652559","GSM2652560","GSM2652561","GSM2652562","GSM2652563",
"GSM2652564","GSM2652565","GSM2652566","GSM2652567","GSM2652568","GSM2652569","GSM2652570","GSM2652571","GSM2652572","GSM2652573","GSM2652574","GSM2652575","GSM2652576","GSM2652577","GSM2652578","GSM2652579","GSM2652580","GSM2652581","GSM2652582","GSM2652583","GSM2652584","GSM2652585","GSM2652586","GSM2652587","GSM2482834","GSM2482835","GSM2482836","GSM2482837","GSM2482838","GSM2482839",
"GSM2482840","GSM2482841","GSM2393184","GSM2393185","GSM2393186","GSM2393187","GSM2393188","GSM2393189","GSM2393190","GSM2393191","GSM2393192","GSM2393193","GSM2393194","GSM2393195","GSM2730045","GSM2730046","GSM2730047","GSM2730048","GSM2730049","GSM2730050","GSM2730051","GSM2730052","GSM1279771","GSM1279772","GSM3005048","GSM3005049","GSM3005050","GSM3005051","GSM3005052","GSM3005053",
"GSM1778901","GSM1778903","GSM1778904","GSM3391626","GSM3391627","GSM3391628","GSM3145602","GSM3145603","GSM1533838","GSM2585347","GSM2585348","GSM2585349","GSM2585350","GSM2585351","GSM2585352","GSM2585353","GSM2585354","GSM2585355","GSM2585356","GSM2585357","GSM2585358","GSM2784956","GSM2784957","GSM2784958","GSM2784959","GSM2784960","GSM2784961","GSM2784962","GSM2784963","GSM2784964",
"GSM2784965","GSM2784966","GSM2784967","GSM2784968","GSM2784969","GSM2784970","GSM2784971","GSM3319568","GSM3319569","GSM3319570","GSM3319571","GSM3319572","GSM3319573","GSM3319574","GSM3319575","GSM3319576","GSM3319577","GSM3535782","GSM3535783","GSM3535784","GSM3535785","GSM3535786","GSM3535787","GSM2842710","GSM2842711","GSM2842712","GSM2842713","GSM2842714","GSM2842715","GSM2842716",
"GSM2842717","GSM2842718","GSM2842719","GSM2842720","GSM2842721","GSM2842722","GSM2842723","GSM2842724","GSM2842725","GSM2842726","GSM2842727","GSM2842728","GSM2842729","GSM2842730","GSM2842731","GSM2842732","GSM2842733","GSM2842734","GSM2842735","GSM2842736","GSM2842737","GSM2842738","GSM2842739","GSM2842740","GSM2842741","GSM2842742","GSM2842743","GSM2842744","GSM2842745","GSM2842746",
"GSM2842747","GSM2842748","GSM2842749","GSM2842750","GSM2842751","GSM2842752","GSM2842753","GSM2842754","GSM2842755","GSM2842756","GSM2842757","GSM2892494","GSM2892495","GSM2892496","GSM2892497","GSM2892498","GSM2892499","GSM2892500","GSM2892501","GSM2892502","GSM2892503","GSM2892504","GSM2892505","GSM2892506","GSM2892507","GSM2892508","GSM2892509","GSM2892510","GSM2892511","GSM2892512",
"GSM2892513","GSM2892514","GSM2892515","GSM2892516","GSM2892517","GSM2892518","GSM2892519","GSM2892520","GSM2892521","GSM3145509","GSM3145510","GSM3145511","GSM3145512","GSM3145513","GSM3145514","GSM3145515","GSM3145516","GSM3336357","GSM3336358","GSM3336359","GSM3336360","GSM3336361","GSM3336362","GSM3336363","GSM3336364","GSM3336365","GSM3336366","GSM3336367","GSM3336368","GSM3336369",
"GSM3336370","GSM3336371","GSM3336372","GSM3336373","GSM3336374","GSM3336375","GSM3336376","GSM3336377","GSM3336378","GSM3336379","GSM3336380","GSM3336382","GSM3336383","GSM3336384","GSM3336385","GSM3336387","GSM3336388","GSM3336389","GSM3336390","GSM3336391","GSM3336392","GSM3336393","GSM3336394","GSM3336395","GSM3336396","GSM3336397","GSM3336398","GSM3336399","GSM3336400","GSM3336401",
"GSM3336402","GSM3336403","GSM3336404","GSM3336405","GSM3336406","GSM3336407","GSM3336408","GSM3336409","GSM3336410","GSM3336412","GSM3336413","GSM3336414","GSM3336416","GSM3336417","GSM3336418","GSM3336419","GSM3336420","GSM3336421","GSM3336422","GSM3336423","GSM3336424","GSM3336425","GSM3336426","GSM3336427","GSM3259535","GSM3259536","GSM3259537","GSM3259538","GSM3259539","GSM3259540",
"GSM3259541","GSM3259542","GSM3259543","GSM3259544","GSM3259545","GSM3259546","GSM3259547","GSM3259548","GSM3259549","GSM3259550","GSM3259551","GSM3259552","GSM3273280","GSM3273281","GSM3273282","GSM3273283","GSM3273284","GSM3273285","GSM3097225","GSM3097226","GSM3097227","GSM3097228","GSM3097229","GSM3097230","GSM3097231","GSM3097232","GSM3724199","GSM3177285","GSM3177286","GSM3177287",
"GSM3177288","GSM3177289","GSM3177290","GSM3177291","GSM3177292","GSM3177293","GSM3177294","GSM3177295","GSM3177296","GSM3177297","GSM3177298","GSM3177299","GSM3177300","GSM3177301","GSM3177302","GSM3273049","GSM3273050","GSM3273051","GSM3273052","GSM3273053","GSM3273054","GSM3273055","GSM3273056","GSM3273057","GSM3273058","GSM3273059","GSM3273060","GSM3436894","GSM3436895","GSM3436896",
"GSM3436897","GSM3436898","GSM3436899","GSM3436900","GSM3436901","GSM3436902","GSM3436903","GSM3436904","GSM3436905","GSM3436906","GSM3436907","GSM3436908","GSM3436909","GSM3666836","GSM3666837","GSM3666838","GSM3290823","GSM3290824","GSM3290825","GSM3290826","GSM3290827","GSM3290828","GSM3290829","GSM3290830","GSM3290831","GSM3290832","GSM3290833","GSM3290834","GSM3692919","GSM3692920",
"GSM3692921","GSM3692922","GSM3692923","GSM3692924","GSM3692925","GSM3692926","GSM3567171","GSM3567172","GSM3567173","GSM3567174","GSM3567175","GSM3567176","GSM3567183","GSM3567184","GSM3567185","GSM3567186","GSM3567195","GSM3567196","GSM3567197","GSM3567198","GSM3567199","GSM3567200","GSM3715168","GSM3715169","GSM3715170","GSM3715171","GSM3715172","GSM3715173","GSM3294563","GSM3294564",
"GSM3294565","GSM3294566","GSM3294567","GSM3294568","GSM3294569","GSM3294570","GSM3294571","GSM3294572","GSM3294573","GSM3294574","GSM3294575","GSM3294576","GSM3294577","GSM3294578","GSM3294579","GSM3294580","GSM3378079","GSM3378080","GSM3378081","GSM3378082","GSM3378083","GSM3378084","GSM3741893","GSM3741894","GSM3741895","GSM3741896","GSM3741897","GSM3741898","GSM3741899","GSM3741900",
"GSM3741901","GSM3741902","GSM3741903","GSM3741904","GSM3741905","GSM3741906","GSM3741907","GSM3741908","GSM3741909","GSM3741910","GSM3741911","GSM3741912","GSM3741913","GSM3741914","GSM3741915","GSM3741916","GSM3741917","GSM3741918","GSM3741919","GSM3741920","GSM3741921","GSM3741922","GSM3741923","GSM3741924","GSM3741925","GSM3741926","GSM3741927","GSM3741928","GSM3741929","GSM3741930",
"GSM3741931","GSM3741932","GSM3741933","GSM3741934","GSM2760526","GSM2760527","GSM2760528","GSM2760529","GSM2760530","GSM2760531","GSM2760532","GSM3138644","GSM3138645","GSM3138646","GSM3138647","GSM3138648","GSM3138649","GSM3138650","GSM3138651","GSM3138652","GSM3138653","GSM3138654","GSM3138655","GSM3138656","GSM3138657","GSM3138658","GSM3138659","GSM3907360","GSM3907361","GSM3907362",
"GSM3907363","GSM3907364","GSM3907365","GSM3907366","GSM3907367","GSM3907368","GSM3907369","GSM3907371","GSM3907373","GSM4066283","GSM4066284","GSM4066285","GSM4066286","GSM4066287","GSM4066288","GSM4066289","GSM4066290","GSM4066291","GSM4066292","GSM4066293","GSM4066294","GSM4066295","GSM4066296","GSM4066297","GSM4066298","GSM4066299","GSM4066300","GSM4066301","GSM4066302","GSM4066303",
"GSM4066304","GSM4066305","GSM4066306","GSM3737429","GSM3737430","GSM4037030","GSM4037031","GSM4037032","GSM4037033","GSM4037034","GSM4037035","GSM3131593","GSM3131594","GSM3131595","GSM3131596","GSM3131597","GSM3131598","GSM3131599","GSM3131600","GSM3131601","GSM3131602","GSM3131603","GSM3131604","GSM3261821","GSM3261822","GSM3261823","GSM3261824","GSM3261825","GSM3261826","GSM3261827",
"GSM3261828","GSM3315355","GSM3315356","GSM3315357","GSM3315358","GSM3424008","GSM3424009","GSM3424010","GSM3684391","GSM3684392","GSM3684393","GSM3684394","GSM3684395","GSM3684396","GSM3734464","GSM3734465","GSM3734466","GSM3734467","GSM3734468","GSM3734469","GSM3734470","GSM3734471","GSM3734472","GSM3734473","GSM3734474","GSM3734475","GSM3841582","GSM3841583","GSM3841584","GSM3841585",
"GSM3841586","GSM3841587","GSM3841588","GSM3841589","GSM3841590","GSM3841591","GSM3841592","GSM3841593","GSM4043802","GSM4043803","GSM4043804","GSM4043805","GSM4043806","GSM4043807","GSM4043808","GSM4043809","GSM4043810","GSM4089220","GSM4089221","GSM4089222","GSM4089223","GSM4089224","GSM4089225","GSM4089226","GSM4089227","GSM4089228","GSM4089229","GSM4089230","GSM4089231","GSM4089232",
"GSM4089233","GSM4089234","GSM4089235","GSM4089236","GSM4089237","GSM4089238","GSM4089239","GSM4132998","GSM4133003","GSM4133005","GSM4133008","GSM4133010","GSM4133012","GSM4133015","GSM4133017","GSM4133019","GSM4133022","GSM4133024","GSM4133026","GSM4133029","GSM4133031","GSM4133033","GSM4133036","GSM4133038","GSM4133040","GSM4133043","GSM4133045","GSM4133047","GSM4133049","GSM4133052",
"GSM4133054","GSM4133056","GSM4133059","GSM4133061","GSM4230111","GSM4230112","GSM4230113","GSM4230114","GSM4230115","GSM4230116","GSM4230117","GSM4230118","GSM4276548","GSM4276550","GSM4276551","GSM4276552","GSM4276553","GSM4422608","GSM4422609","GSM4422610","GSM4422611","GSM4422612","GSM4422613","GSM4422614","GSM4422615","GSM4422616","GSM4422617","GSM4422618","GSM4422619","GSM4422620",
"GSM4422621","GSM4422622","GSM4422623","GSM4422624","GSM4422625","GSM4422626","GSM4422627","GSM4422628","GSM4422629","GSM4422630","GSM4422631","GSM4447077","GSM4447078","GSM4447079","GSM4447080","GSM4447081","GSM4447082","GSM4501133","GSM4501134","GSM4501135","GSM4501136","GSM4501137","GSM4501138","GSM4501139","GSM4501140","GSM4501141","GSM4501142","GSM4501143","GSM4501144","GSM4501145",
"GSM4501146","GSM4501147","GSM4501148","GSM4501149","GSM4501150","GSM4501151","GSM4501152","GSM4501153","GSM4501154","GSM4501155","GSM4501156","GSM4501157","GSM4501158","GSM4501159","GSM4501160","GSM4501161","GSM4501162","GSM4501163","GSM4501164","GSM4501165","GSM4501166","GSM4501167","GSM4501168","GSM4501169","GSM4501170","GSM4501171","GSM4501172","GSM4501173","GSM4501174","GSM4501175",
"GSM4501176","GSM4501177","GSM4501178","GSM4501179","GSM4501180","GSM4501181","GSM4501182","GSM4501183","GSM4501184","GSM4501185","GSM4501186","GSM4501187","GSM4501188","GSM4501189","GSM4501190","GSM4501191","GSM4501192","GSM4501193","GSM4501194","GSM4501195","GSM4501196","GSM4501197","GSM4501198","GSM4501199","GSM4501200","GSM4501201","GSM4501202","GSM4501203","GSM4501204","GSM4501205",
"GSM4501206","GSM4501207","GSM4501208","GSM4501209","GSM4501210","GSM4501211","GSM4501212","GSM4501213","GSM4501214","GSM4501215","GSM4501216","GSM4501217","GSM4501218","GSM4501219","GSM4501220","GSM4501221","GSM4501222","GSM4501223","GSM4501224","GSM4501225","GSM4501226","GSM4501227","GSM4501228","GSM4501229","GSM4501230","GSM4501231","GSM4501232","GSM4501233","GSM4501234","GSM4501236",
"GSM4501237","GSM4501238","GSM4501239","GSM4501240","GSM4501241","GSM4501242","GSM4501243","GSM4501244","GSM4501245","GSM4501246","GSM4501247","GSM4501248","GSM4501249","GSM4501250","GSM4501251","GSM4501252","GSM4501253","GSM4501254","GSM4501255","GSM4501256","GSM4501257","GSM4501258","GSM4501259","GSM4501260","GSM4501261","GSM4501262","GSM4501263","GSM4501264","GSM4501265","GSM4501266",
"GSM4501267","GSM4501268","GSM4501269","GSM4501270","GSM4501271","GSM4501272","GSM4501273","GSM4501274","GSM4501275","GSM4501276","GSM3488649","GSM3488651","GSM3488653","GSM3488654","GSM3488656","GSM3488658","GSM3488659","GSM3488661","GSM3488662","GSM3488664","GSM3488666","GSM3488667","GSM3488669","GSM3488671","GSM3488673","GSM3488676","GSM3488677","GSM3488679","GSM3488681","GSM3488682",
"GSM3488684","GSM4133000","GSM4238090","GSM4238091","GSM4238092","GSM4238093","GSM4238094","GSM4238095","GSM4296576","GSM4296577","GSM4296578","GSM4296579","GSM4296580","GSM4296581","GSM4610258","GSM4610259","GSM4610260","GSM4610261","GSM4610262","GSM4610263","GSM4610264","GSM4610265","GSM4610266","GSM4610267","GSM4610268","GSM4610269","GSM4610270","GSM4610271","GSM4610272","GSM4610273",
"GSM4802781","GSM4802782","GSM4802783","GSM4802784","GSM4802785","GSM4802786","GSM4802787","GSM4802788","GSM4802789","GSM4802790","GSM4802791","GSM4802792","GSM4802793","GSM4802794","GSM4802795","GSM4802796","GSM4802797","GSM4802798","GSM4802799","GSM4802800","GSM4802801","GSM4802802","GSM4802803","GSM4802804","GSM4889188","GSM4889189","GSM4889190","GSM4889191","GSM4903843","GSM4903844",
"GSM4903845","GSM4903846","GSM4903847","GSM4903848","GSM4903849","GSM4903850","GSM4903851","GSM4903852","GSM4912746","GSM4912747","GSM4981333","GSM4981334","GSM4981336","GSM4981337","GSM4981338","GSM3137212","GSM3137213","GSM3137214","GSM3639309","GSM3639310","GSM3639311","GSM3639312","GSM3639313","GSM3639314","GSM3639315","GSM3639316","GSM3639317","GSM3639318","GSM3639319","GSM3639320",
"GSM3724194","GSM3724195","GSM3724196","GSM3724197","GSM3724198","GSM4399854","GSM4399855","GSM4399857","GSM4399858","GSM4399859","GSM4447591","GSM4447592","GSM4447593","GSM4447594","GSM4447595","GSM4447596","GSM4447777","GSM4447778","GSM4447779","GSM4447780","GSM4447781","GSM4447782","GSM4447783","GSM4447784","GSM4544047","GSM4544048","GSM4544049","GSM4544053","GSM4544057","GSM4572093",
"GSM4572094","GSM4572096","GSM4572097","GSM4572098","GSM4572099","GSM4572101","GSM4572102","GSM4572103","GSM4572104","GSM4572105","GSM4572107","GSM4572108","GSM4572110","GSM4577991","GSM4577992","GSM4802778","GSM4802779","GSM4802780","GSM4835630","GSM4835632","GSM4835637","GSM4835640","GSM4872600","GSM4872601","GSM4872615","GSM4872616","GSM4878096","GSM4878097","GSM4878098","GSM4878099",
"GSM4878101","GSM4890996","GSM4890997","GSM4890998","GSM4891001","GSM4891003","GSM4891004","GSM4891005","GSM4891006","GSM4891007","GSM4904490","GSM4904492","GSM4904493","GSM4904494","GSM4904495","GSM4904497","GSM4904498","GSM4904501","GSM4904502","GSM4904503","GSM4904504","GSM4904505","GSM4904506","GSM4904507","GSM4904508","GSM4904509","GSM4904510","GSM4904511","GSM4904522","GSM4904523",
"GSM4904524","GSM4904525","GSM4904526","GSM4904527","GSM4904528","GSM4904529","GSM4904530","GSM4904531","GSM4904532","GSM4904534","GSM4904535","GSM4904536","GSM4904537","GSM4904538","GSM4909120","GSM4909121","GSM4909122","GSM4975463","GSM4975464","GSM4975465","GSM4975466","GSM4975468","GSM4983606","GSM4983607","GSM4983612","GSM4983613","GSM4983615","GSM4983616","GSM4983617","GSM4983618",
"GSM4983619","GSM4983620","GSM4983621","GSM4983622","GSM4983624","GSM4983627","GSM4983628","GSM4983630","GSM4983631","GSM4983632","GSM4983634","GSM4983635","GSM4983636","GSM4983637","GSM4983639","GSM4983640","GSM4983641","GSM4983643","GSM4983644","GSM4983646","GSM5028852","GSM5028853","GSM5028857","GSM5028859","GSM5028861","GSM5028862","GSM5028866","GSM5028868","GSM5028869","GSM5028870",
"GSM5028871","GSM5028872","GSM5028873","GSM5028874","GSM5028875","GSM5028876","GSM5028878","GSM5155390","GSM5155391","GSM5155392","GSM5155393","GSM5155394","GSM5155396","GSM5155397","GSM5155398","GSM5155399","GSM5155400","GSM5155401","GSM5155402","GSM5155403","GSM5155405","GSM5155406","GSM5155407","GSM5155408","GSM5155409","GSM5155410","GSM5155411","GSM5155412","GSM5155413","GSM5161288",
"GSM5264272","GSM5264273","GSM5264274","GSM5264275","GSM5265980","GSM5265981","GSM5265982","GSM5265983","GSM5265985","GSM5265986","GSM5265987","GSM5265988","GSM5265989","GSM5265990","GSM5265991","GSM5460873","GSM5460874","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/samples/geo_accession")
genes = h5read(destination_file, "meta/genes/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = t(h5read(destination_file, "data/expression", index=list(sample_locations, 1:length(genes))))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE, col.names=NA)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))

