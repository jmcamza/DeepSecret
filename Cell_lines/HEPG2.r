# R script to download selected samples
# Copy code and run on a local machine to initiate download

library("rhdf5")    # can be installed using Bioconductor

destination_file = "human_matrix_v10.h5"
extracted_expression_file = "HEPG2_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix_v10.h5"

# Check if gene expression file was already downloaded, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE, mode = 'wb')
}

# Selected samples to be extracted
samp = c("GSM1704034","GSM1704023","GSM1704036","GSM1704027","GSM2228736","GSM1704021","GSM1704025","GSM1704032","GSM1704037","GSM1704028","GSM1704038","GSM2228737","GSM1975771","GSM1704024","GSM1704020","GSM1704031","GSM1975773","GSM2228735","GSM1975770","GSM1704029","GSM1975772","GSM1704022","GSM1704033","GSM2228741","GSM2228742","GSM1704030","GSM1704035","GSM1861945","GSM1861947","GSM2209496","GSM1861944",
"GSM2209494","GSM1861946","GSM2209495","GSM1704026","GSM2344350","GSM2344353","GSM2343434","GSM2343435","GSM2343291","GSM2343292","GSM2343358","GSM2343354","GSM2343605","GSM2343356","GSM2343603","GSM2343352","GSM2343971","GSM2343970","GSM2343975","GSM2343974","GSM2343977","GSM2343976","GSM2343347","GSM2343345","GSM2343555","GSM2344274","GSM2138841","GSM2138840","GSM2138843","GSM2138842",
"GSM2138847","GSM2138846","GSM2138667","GSM2138666","GSM2344094","GSM2344093","GSM2344091","GSM2343157","GSM2343156","GSM2343959","GSM2343958","GSM2072618","GSM2072617","GSM2344288","GSM2344289","GSM2138860","GSM2138864","GSM2344118","GSM2344119","GSM2344110","GSM2344117","GSM2344073","GSM2344074","GSM2343935","GSM2343936","GSM2343933","GSM2343932","GSM2343939","GSM2343424","GSM2343588",
"GSM2343237","GSM2343235","GSM2343238","GSM2343855","GSM2138805","GSM2138804","GSM2138807","GSM2138806","GSM2344135","GSM2344136","GSM2344131","GSM2344132","GSM2343919","GSM2343078","GSM2343079","GSM2138823","GSM2138822","GSM2138829","GSM2138828","GSM2344154","GSM2344153","GSM2344158","GSM2138748","GSM2138688","GSM2138680","GSM2138686","GSM2343272","GSM2343271","GSM2343092","GSM2343090",
"GSM2343091","GSM2343096","GSM2343097","GSM2343095","GSM2343098","GSM2343890","GSM2343896","GSM2343895","GSM2344174","GSM2344175","GSM2344176","GSM2344177","GSM2344013","GSM2344012","GSM2344211","GSM2343252","GSM2343253","GSM2343257","GSM2343528","GSM2343529","GSM2138679","GSM2138678","GSM2344089","GSM2344192","GSM2344193","GSM2344198","GSM2344199","GSM2343753","GSM2343755","GSM2343754",
"GSM2343756","GSM2343504","GSM2344220","GSM2343501","GSM2343508","GSM2343509","GSM2344422","GSM2344423","GSM2344420","GSM2344421","GSM2344424","GSM2344425","GSM2344428","GSM2344429","GSM2138754","GSM2138861","GSM2138750","GSM2343197","GSM2343196","GSM2343193","GSM2343192","GSM2343771","GSM2343770","GSM2343999","GSM2343998","GSM2344249","GSM2343562","GSM2344243","GSM2343561","GSM2344402",
"GSM2344403","GSM2343617","GSM2344202","GSM2344203","GSM2138719","GSM2138718","GSM2343256","GSM2343170","GSM2344387","GSM2343177","GSM2344384","GSM2343178","GSM2344388","GSM2343714","GSM2343710","GSM2343713","GSM2072545","GSM2343542","GSM2343543","GSM2343544","GSM2343545","GSM2343818","GSM2343819","GSM2138669","GSM2138668","GSM2343246","GSM2344092","GSM2138733","GSM2138732","GSM2138731",
"GSM2138730","GSM2343736","GSM2343735","GSM2343837","GSM2343830","GSM2343831","GSM2343832","GSM2343838","GSM2344332","GSM2344333","GSM2138755","GSM2138751","GSM2343139","GSM2343134","GSM2343133","GSM2343856","GSM2138878","GSM2138879","GSM2343247","GSM2138779","GSM2138778","GSM2138775","GSM2138774","GSM2138771","GSM2138770","GSM2343440","GSM2343445","GSM2343444","GSM2344327","GSM2344326",
"GSM2344022","GSM2343658","GSM2343307","GSM2343877","GSM2343654","GSM2343308","GSM2344224","GSM2344221","GSM2138793","GSM2138792","GSM2138795","GSM2138794","GSM2344309","GSM2344302","GSM2344301","GSM2343465","GSM2343464","GSM2343799","GSM2343798","GSM2343795","GSM2343794","GSM2343791","GSM2343790","GSM2138892","GSM2138893","GSM2138898","GSM2138899","GSM2344320","GSM2343632","GSM2343633",
"GSM2343639","GSM2344325","GSM2344321","GSM2343113","GSM2344324","GSM2344363","GSM2343169","GSM2343613","GSM2343614","GSM2343616","GSM2138863","GSM2343968","GSM2343969","GSM2138862","GSM2343962","GSM2343961","GSM2343964","GSM2343965","GSM2138865","GSM2344344","GSM2344343","GSM2344342","GSM2344341","GSM2344349","GSM2344223","GSM2343287","GSM2343288","GSM2138856","GSM2138857","GSM2138676",
"GSM2138677","GSM2138674","GSM2138675","GSM2138672","GSM2138673","GSM2138670","GSM2138671","GSM2344088","GSM2344080","GSM2344081","GSM2343948","GSM2343947","GSM2343940","GSM2343988","GSM2343765","GSM2138874","GSM2138875","GSM2344062","GSM2344060","GSM2344061","GSM2344066","GSM2344065","GSM2344059","GSM2138783","GSM2343920","GSM2343477","GSM2343478","GSM2344293","GSM2344292","GSM2138816",
"GSM2138817","GSM2138814","GSM2138815","GSM2138812","GSM2138813","GSM2138810","GSM2138811","GSM2344109","GSM2344107","GSM2344106","GSM2344042","GSM2343870","GSM2343659","GSM2343878","GSM2343655","GSM2343900","GSM2343901","GSM2343513","GSM2343512","GSM2343421","GSM2343223","GSM2343225","GSM2343224","GSM2343595","GSM2343594","GSM2343229","GSM2343228","GSM2138830","GSM2138831","GSM2138836",
"GSM2138837","GSM2138838","GSM2138839","GSM2344120","GSM2344126","GSM2344125","GSM2344023","GSM2344020","GSM2344021","GSM2343690","GSM2343691","GSM2343692","GSM2343693","GSM2343697","GSM2343698","GSM2344040","GSM2344041","GSM2138689","GSM2343203","GSM2343202","GSM2344144","GSM2344147","GSM2344143","GSM2344148","GSM2343236","GSM2344004","GSM2344005","GSM2344006","GSM2344007","GSM2343587",
"GSM2343261","GSM2343260","GSM2138742","GSM2343081","GSM2343082","GSM2343089","GSM2343889","GSM2343881","GSM2343882","GSM2343505","GSM2343748","GSM2343749","GSM2343743","GSM2343744","GSM2343502","GSM2344248","GSM2344242","GSM2343245","GSM2343244","GSM2343535","GSM2343536","GSM2344185","GSM2344184","GSM2343441","GSM2343982","GSM2343983","GSM2343989","GSM2343766","GSM2344238","GSM2344237",
"GSM2343604","GSM2343222","GSM2138708","GSM2138709","GSM2138700","GSM2138701","GSM2138704","GSM2138705","GSM2343162","GSM2343163","GSM2343161","GSM2343167","GSM2343164","GSM2344397","GSM2344392","GSM2344393","GSM2343709","GSM2343415","GSM2343413","GSM2138724","GSM2138725","GSM2138726","GSM2138727","GSM2138720","GSM2343147","GSM2343148","GSM2343498","GSM2343499","GSM2343723","GSM2343724",
"GSM2343727","GSM2344257","GSM2344256","GSM2343168","GSM2343554","GSM2344273","GSM2343801","GSM2343800","GSM2343805","GSM2343806","GSM2343114","GSM2344383","GSM2343173","GSM2343174","GSM2344398","GSM2344029","GSM2138743","GSM2138740","GSM2138741","GSM2344024","GSM2138749","GSM2344025","GSM2343640","GSM2343647","GSM2138887","GSM2138886","GSM2343829","GSM2343823","GSM2343822","GSM2072546",
"GSM2138900","GSM2138901","GSM2138902","GSM2138903","GSM2344038","GSM2138768","GSM2138769","GSM2138766","GSM2138767","GSM2344330","GSM2344331","GSM2344037","GSM2344031","GSM2344362","GSM2343332","GSM2343334","GSM2138782","GSM2138780","GSM2138781","GSM2138786","GSM2138787","GSM2138784","GSM2138785","GSM2343474","GSM2344310","GSM2344311","GSM2344312","GSM2343473","GSM2344354","GSM2343782",
"GSM2343781","GSM2344052","GSM2344051","GSM2344266","GSM2344055","GSM2344267","GSM2344054","GSM2343606","GSM2138721","GSM2343864","GSM2343863","GSM2343646","GSM2343649","GSM2343648","GSM2343869","GSM2343140","GSM2343490","GSM2344157","GSM2343491","GSM2344210","GSM2343728","GSM2344039","GSM2344035","GSM2344034","GSM2344374","GSM2344375","GSM2344372","GSM2344373","GSM2344036","GSM2344030",
"GSM2344033","GSM2344032","GSM2138885","GSM2138884","GSM2138883","GSM2138882","GSM2138681","GSM2138687","GSM2343627","GSM2343626","GSM2343623","GSM2343622","GSM2343629","GSM2343628","GSM2197718","GSM2197716","GSM2197717","GSM2463218","GSM2463220","GSM2463221","GSM2463222","GSM2463223","GSM2463219","GSM2629612","GSM2629613","GSM2629614","GSM2629615","GSM2629616","GSM2629617","GSM2586967",
"GSM2586968","GSM2586969","GSM2586970","GSM2586971","GSM2586972","GSM2932791","GSM2932792","GSM2932793","GSM2932794","GSM2932795","GSM2932796","GSM2932797","GSM2932798","GSM2932799","GSM2932800","GSM2932801","GSM2932802","GSM2183589","GSM2183590","GSM2183591","GSM2183592","GSM2183593","GSM2183594","GSM2183595","GSM2183596","GSM2183597","GSM2183598","GSM2183599","GSM2183600","GSM2766531",
"GSM2766532","GSM2766533","GSM2766534","GSM2766535","GSM2766536","GSM2680342","GSM2680343","GSM2891830","GSM2891831","GSM2891836","GSM2891837","GSM2740942","GSM2740943","GSM2740944","GSM2740945","GSM2740946","GSM2740947","GSM2740948","GSM2740949","GSM2740950","GSM2740951","GSM2740952","GSM2740953","GSM2740954","GSM2740955","GSM2740956","GSM2931164","GSM2931165","GSM2931166","GSM2931167",
"GSM2931168","GSM2931169","GSM2931170","GSM2931171","GSM2931172","GSM2943835","GSM2943836","GSM2943837","GSM2943838","GSM2943839","GSM2943840","GSM2943841","GSM2943842","GSM2943843","GSM2943844","GSM2943845","GSM2943846","GSM2943847","GSM2943848","GSM2943849","GSM2095704","GSM2095705","GSM2095706","GSM2095707","GSM2125267","GSM2125268","GSM2125269","GSM2125270","GSM2125271","GSM2125272",
"GSM2125273","GSM2125274","GSM2125275","GSM2125276","GSM2125277","GSM2125278","GSM2409802","GSM2409803","GSM2409804","GSM2409805","GSM2410384","GSM2410385","GSM2410386","GSM2410387","GSM2410388","GSM2410389","GSM2410390","GSM2410391","GSM2410392","GSM2410393","GSM2410394","GSM2410395","GSM2410396","GSM2410397","GSM2410398","GSM2410399","GSM2410400","GSM2410401","GSM2410402","GSM2410403",
"GSM2410404","GSM2410405","GSM2410406","GSM2410407","GSM2410408","GSM2410409","GSM2410410","GSM2410411","GSM2410412","GSM2410413","GSM3300793","GSM3300794","GSM2039755","GSM2039757","GSM2039759","GSM2039761","GSM2039763","GSM2039765","GSM2039769","GSM2039770","GSM2039771","GSM2757325","GSM2757326","GSM2757327","GSM2757328","GSM2757329","GSM2757330","GSM3150203","GSM3150204","GSM3150205",
"GSM3150206","GSM3150207","GSM3150208","GSM2565934","GSM2565935","GSM2565936","GSM2565937","GSM2565938","GSM2565939","GSM3105101","GSM3105102","GSM3105103","GSM3105104","GSM2862007","GSM2862008","GSM2862009","GSM2862010","GSM2862011","GSM2862012","GSM2862013","GSM2862014","GSM2862015","GSM2862016","GSM2862017","GSM2862018","GSM2862019","GSM2862020","GSM3495150","GSM3495151","GSM3495152",
"GSM3495153","GSM2864795","GSM2864796","GSM2864797","GSM2864798","GSM2864799","GSM2864800","GSM2864801","GSM2864802","GSM2864803","GSM2864804","GSM2864805","GSM2864806","GSM3379700","GSM3379701","GSM3379702","GSM3379703","GSM3450377","GSM3450378","GSM3450379","GSM3450380","GSM3450381","GSM3450382","GSM3450383","GSM3450384","GSM3450385","GSM3450386","GSM3450387","GSM3450388","GSM3450389",
"GSM3450390","GSM3450391","GSM3450392","GSM3450393","GSM3450394","GSM3450395","GSM3450396","GSM3450397","GSM3450398","GSM3450399","GSM3450400","GSM2864911","GSM2864912","GSM2864913","GSM2864914","GSM2864915","GSM2864916","GSM2864917","GSM2864918","GSM2864919","GSM2864920","GSM2864921","GSM2864922","GSM2864923","GSM2864924","GSM2864925","GSM2864926","GSM2864927","GSM2864928","GSM3556991",
"GSM3556992","GSM3556993","GSM3556994","GSM3556995","GSM3556996","GSM3556997","GSM3556998","GSM3556999","GSM3557000","GSM3557001","GSM3557002","GSM3557003","GSM3557004","GSM3557005","GSM3557006","GSM3443132","GSM3443133","GSM3443183","GSM3443184","GSM3443185","GSM3443186","GSM3443187","GSM3443188","GSM3443189","GSM3443190","GSM3443191","GSM3443192","GSM3443193","GSM3443194","GSM3700992",
"GSM2344889","GSM2344890","GSM2344891","GSM2344892","GSM2344893","GSM2344894","GSM2344895","GSM2344896","GSM3577347","GSM3577348","GSM3577349","GSM3577350","GSM3577351","GSM3577352","GSM3577353","GSM3577354","GSM3577355","GSM3577356","GSM3577357","GSM3577358","GSM3577359","GSM3577360","GSM3577361","GSM3577362","GSM3577363","GSM3577364","GSM3577365","GSM3577366","GSM3577367","GSM3577368",
"GSM3577369","GSM3577370","GSM3577371","GSM3577372","GSM3577373","GSM3577374","GSM3577375","GSM3577376","GSM3577377","GSM3577378","GSM3577379","GSM3577380","GSM3577381","GSM3577382","GSM3577383","GSM3577384","GSM3577385","GSM3577386","GSM3577387","GSM3577388","GSM3577389","GSM3577390","GSM3577391","GSM3577392","GSM3577393","GSM3577394","GSM3577395","GSM3577396","GSM3577397","GSM3577398",
"GSM3577399","GSM3577400","GSM3577401","GSM3577402","GSM3577403","GSM3577404","GSM3577405","GSM3577406","GSM3577407","GSM3577408","GSM3577409","GSM3577410","GSM3577411","GSM3577412","GSM3577413","GSM3577414","GSM3577415","GSM3577416","GSM3577417","GSM3577418","GSM3577419","GSM3577420","GSM3577421","GSM3577422","GSM3577423","GSM3577424","GSM3577425","GSM3577426","GSM3931552","GSM3931553",
"GSM3931554","GSM3931555","GSM3931556","GSM3931557","GSM4126925","GSM4126926","GSM4126927","GSM4126928","GSM4126929","GSM4126930","GSM3972204","GSM3972205","GSM3972206","GSM3972207","GSM3972208","GSM3972209","GSM3972210","GSM3972211","GSM3972212","GSM3972213","GSM3972214","GSM3972215","GSM3972216","GSM3972217","GSM3972218","GSM3972219","GSM3972220","GSM3972221","GSM3972222","GSM3972223",
"GSM3972224","GSM3972225","GSM3972226","GSM3972227","GSM3972228","GSM3972229","GSM3972230","GSM3972231","GSM3972232","GSM3972233","GSM3972234","GSM3972235","GSM3972236","GSM3972237","GSM3972238","GSM3972239","GSM3972240","GSM3972241","GSM3972242","GSM3972243","GSM3972244","GSM3972245","GSM3972246","GSM3972247","GSM3972248","GSM3972249","GSM3972250","GSM3972251","GSM3972252","GSM3972253",
"GSM3972254","GSM3972255","GSM2564099","GSM2564100","GSM2564101","GSM2564102","GSM2564103","GSM2564104","GSM2564106","GSM2564107","GSM2564109","GSM2564110","GSM2564111","GSM2564112","GSM2564113","GSM2564114","GSM2564116","GSM2564117","GSM2702871","GSM2742671","GSM2742672","GSM2742673","GSM2742674","GSM3718064","GSM4173618","GSM4173619","GSM4173620","GSM4173621","GSM4173622","GSM4173623",
"GSM4273090","GSM4273091","GSM4273092","GSM4273093","GSM4273094","GSM4273095","GSM4273096","GSM4273097","GSM4273098","GSM4273099","GSM4273100","GSM4273101","GSM4273102","GSM4273103","GSM4273104","GSM4273105","GSM4273106","GSM4273107","GSM4273108","GSM4273109","GSM4273110","GSM4273111","GSM4273112","GSM4273113","GSM4273114","GSM4273115","GSM4273116","GSM4273117","GSM4273118","GSM4273119",
"GSM4273120","GSM4273121","GSM4276184","GSM4276185","GSM4276186","GSM4276187","GSM4276188","GSM4276189","GSM4308521","GSM4308522","GSM4308523","GSM4308524","GSM4317635","GSM4317636","GSM4317637","GSM4317638","GSM4363674","GSM4363675","GSM4363676","GSM4363677","GSM4363678","GSM4363679","GSM4363680","GSM4363681","GSM4363682","GSM4363683","GSM4363684","GSM4363685","GSM4363686","GSM4363687",
"GSM4363688","GSM4363689","GSM4363690","GSM4363691","GSM4363692","GSM4363693","GSM4364028","GSM4364029","GSM4364030","GSM4364031","GSM4364032","GSM4364033","GSM4367478","GSM4367479","GSM4416978","GSM4416979","GSM4416980","GSM4416981","GSM4416982","GSM4416983","GSM4562488","GSM4562489","GSM4562490","GSM4684611","GSM4684612","GSM4684613","GSM4684614","GSM4684615","GSM4684616","GSM2564108",
"GSM2564115","GSM3167475","GSM3167476","GSM3478959","GSM3478960","GSM3478961","GSM3478962","GSM3478963","GSM3478964","GSM3478965","GSM3478966","GSM3478967","GSM3732573","GSM3732574","GSM3732575","GSM3732576","GSM3732577","GSM3732578","GSM3768170","GSM3768171","GSM3768172","GSM3768173","GSM3768174","GSM3768175","GSM3768176","GSM3768177","GSM3768178","GSM3768179","GSM3768180","GSM3768181",
"GSM3768182","GSM3768183","GSM3768184","GSM3856522","GSM3856523","GSM3856524","GSM3856525","GSM3856526","GSM3856527","GSM4232507","GSM4340681","GSM4340682","GSM4340683","GSM4340684","GSM4418997","GSM4418998","GSM4418999","GSM4419000","GSM4419001","GSM4419002","GSM4443760","GSM4443762","GSM4443763","GSM4443764","GSM4443765","GSM4443766","GSM4443767","GSM4443768","GSM4443769","GSM4443770",
"GSM4443771","GSM4443772","GSM4443773","GSM4443774","GSM4443775","GSM4443776","GSM4443778","GSM4443779","GSM4443780","GSM4443781","GSM4443782","GSM4443784","GSM4443785","GSM4443786","GSM4443787","GSM4443788","GSM4443790","GSM4443791","GSM4443792","GSM4443793","GSM4443794","GSM4443795","GSM4771687","GSM4771688","GSM4771689","GSM4771690","GSM4771691","GSM4771692","GSM4771693","GSM4771694",
"GSM4771695","GSM4771696","GSM4771697","GSM4771698","GSM2592890","GSM2592891","GSM2592892","GSM2592893","GSM2592894","GSM2592895","GSM2592896","GSM2592897","GSM3705209","GSM3705213","GSM3705214","GSM4050798","GSM4050799","GSM4050801","GSM4050802","GSM4050803","GSM4050804","GSM4050805","GSM4050806","GSM4050807","GSM4050808","GSM4050809","GSM4050810","GSM4050811","GSM4050813","GSM4050814",
"GSM4050815","GSM4050816","GSM4050817","GSM4050820","GSM4050821","GSM4133281","GSM4133282","GSM4194617","GSM4194620","GSM4194621","GSM4194622","GSM4232501","GSM4232502","GSM4232503","GSM4232504","GSM4232505","GSM4232506","GSM4258728","GSM4563656","GSM4563657","GSM4563658","GSM4563659","GSM4563660","GSM4563661","GSM4563662","GSM4563663","GSM4563664","GSM4563665","GSM4563666","GSM4563667",
"GSM4563668","GSM4563669","GSM4563671","GSM4563672","GSM4563673","GSM4563674","GSM4563675","GSM4563676","GSM4563677","GSM4563678","GSM4563679","GSM4563680","GSM4563681","GSM4563682","GSM4563683","GSM4563684","GSM4563685","GSM4563686","GSM4563687","GSM4563688","GSM4563689","GSM4563690","GSM4563691","GSM4563692","GSM4563693","GSM4563694","GSM4563695","GSM4563696","GSM4563697","GSM4563698",
"GSM4563699","GSM4563700","GSM4563701","GSM4563702","GSM4563703","GSM4563704","GSM4563705","GSM4563706","GSM4563707","GSM4563708","GSM4563709","GSM4563710","GSM4563711","GSM4563712","GSM4563713","GSM4563714","GSM4563715","GSM4563716","GSM4563717","GSM4563718","GSM4563719","GSM4563720","GSM4563721","GSM4563722","GSM4563723","GSM4563724","GSM4563725","GSM4563726","GSM4563728","GSM4563730",
"GSM4563731","GSM4563732","GSM4563734","GSM4563735","GSM4563736","GSM4563737","GSM4563738","GSM4563739","GSM4563740","GSM4563741","GSM4563742","GSM4563744","GSM4563745","GSM4563746","GSM4563747","GSM4563748","GSM4563749","GSM4563750","GSM4563751","GSM4563752","GSM4563753","GSM4563754","GSM4563755","GSM4563756","GSM4563757","GSM4563758","GSM4563759","GSM4563760","GSM4563761","GSM4563762",
"GSM4563763","GSM4563764","GSM4563765","GSM4563766","GSM4563767","GSM4563768","GSM4563769","GSM4563770","GSM4563771","GSM4563772","GSM4563773","GSM4563774","GSM4563775","GSM4563776","GSM4563777","GSM4563778","GSM4563779","GSM4563780","GSM4563781","GSM4563782","GSM4563783","GSM4563784","GSM4563785","GSM4563786","GSM4563787","GSM4563788","GSM4563789","GSM4563790","GSM4563791","GSM4563793",
"GSM4563794","GSM4563795","GSM4563796","GSM4563797","GSM4563798","GSM4563799","GSM4563800","GSM4563801","GSM4563802","GSM4563803","GSM4563804","GSM4563805","GSM4563806","GSM4563807","GSM4563808","GSM4563809","GSM4563810","GSM4563811","GSM4563812","GSM4563813","GSM4802741","GSM4802742","GSM4802743","GSM4802744","GSM4802745","GSM4802746","GSM4802747","GSM4802748","GSM4802749","GSM4813878",
"GSM4813879","GSM4813880","GSM4813881","GSM4813882","GSM4813883","GSM4813884","GSM4813885","GSM4813886","GSM4813887","GSM4813888","GSM4813889","GSM4813890","GSM4813891","GSM4813892","GSM4813893","GSM4813894","GSM4813895","GSM4813897","GSM4813898","GSM4813899","GSM5014871","GSM5014872","GSM5014873","GSM5014876","GSM5062259","GSM5062260","GSM5062261","GSM5088089","GSM5088090","GSM5088091",
"GSM5088092","GSM5088093","GSM5088094","GSM5088095","GSM5088096","GSM5088097","GSM5088099","GSM5088100","GSM5088101","GSM5088102","GSM5088103","GSM5088104","GSM5088105","GSM5088106","GSM5088107","GSM5088108","GSM5088109","GSM5088110","GSM5088111","GSM5088112","GSM5098895","GSM5098896","GSM5098897","GSM5098899","GSM5098900","GSM5144629","GSM5144631","GSM5144632","GSM5144633","GSM5145791",
"GSM5145792","GSM5145794","GSM5145795","GSM5310244","GSM5310245","GSM5310246","GSM5310247","GSM5330924","GSM5332602","GSM5332604","GSM5332605","GSM5342966","GSM5369493","GSM5369494","GSM5369551","GSM5369552","GSM5369629","GSM5369630","GSM5369670","GSM5369671","GSM5369672","GSM5369673","GSM5369680","GSM5369681","GSM5369698","GSM5369699","GSM5369729","GSM5369730","GSM5369767","GSM5369768",
"GSM5369824","GSM5369832","GSM5369833","GSM5369884","GSM5369885","GSM5369898","GSM5369924","GSM5369925","GSM5369948","GSM5369949","GSM5369996","GSM5369997","GSM5370025","GSM5370026","GSM5370055","GSM5370056","GSM5370072","GSM5370073","GSM5370133","GSM5370134","GSM5370163","GSM5370164","GSM5370243","GSM5370244","GSM5370282","GSM5370283","GSM5370324","GSM5370325","GSM5370390","GSM5370391",
"GSM5370405","GSM5370406","GSM5370407","GSM5370428","GSM5370429","GSM5370464","GSM5370465","GSM5370486","GSM5370487","GSM5370494","GSM5370495","GSM5370496","GSM5370498","GSM5370499","GSM5370500","GSM5370501","GSM5370529","GSM5370530","GSM5370539","GSM5370540","GSM5370542","GSM5370556","GSM5370557","GSM5370573","GSM5370574","GSM5373938","GSM5373939","GSM5373942","GSM5373943","GSM5373950",
"GSM5373954","GSM5373955","GSM5373958","GSM5373959","GSM5373985","GSM5373986","GSM5374024","GSM5374025","GSM5374034","GSM5374035","GSM5374048","GSM5374049","GSM5374054","GSM5374055","GSM5374058","GSM5374059","GSM5374092","GSM5374093","GSM5374096","GSM5374098","GSM5374128","GSM5374129","GSM5374155","GSM5374156","GSM5374164","GSM5374178","GSM5374199","GSM5374200","GSM5374254","GSM5374255",
"GSM5374260","GSM5374261","GSM5374263","GSM5374264","GSM5374265","GSM5374280","GSM5374307","GSM5374308","GSM5374309","GSM5374314","GSM5374357","GSM5374448","GSM5374449","GSM5374454","GSM5374455","GSM5374470","GSM5374482","GSM5374483","GSM5374490","GSM5374491","GSM5374534","GSM5374535","GSM5374560","GSM5374561","GSM5374562","GSM5374568","GSM5374569","GSM5374588","GSM5374589","GSM5374610",
"GSM5374611","GSM5374621","GSM5374622","GSM5374638","GSM5374639","GSM5374648","GSM5374649","GSM5374669","GSM5374670","GSM5374677","GSM5374678","GSM5374699","GSM5374700","GSM5374748","GSM5374749","GSM5374789","GSM5374790","GSM5374794","GSM5374795","GSM5374815","GSM5374833","GSM5374834","GSM5375017","GSM5375018","GSM5375105","GSM5375106","GSM5375109","GSM5375110","GSM5375121","GSM5375122",
"GSM5375141","GSM5375142","GSM5375212","GSM5375213","GSM5375218","GSM5375219","GSM5375222","GSM5375223","GSM5375271","GSM5375272","GSM5375420","GSM5375421","GSM5375468","GSM5375473","GSM5375474","GSM5375519","GSM5375520","GSM5378289","GSM5378291","GSM5378543","GSM5378544","GSM5378551","GSM5378552","GSM5378570","GSM5378572","GSM5378573","GSM5378574","GSM5378575","GSM5378601","GSM5378602",
"GSM5378705","GSM5378706","GSM5378707","GSM5378708","GSM5378767","GSM5378768","GSM5378788","GSM5378789","GSM5378808","GSM5378809","GSM5378867","GSM5378868","GSM5378885","GSM5378894","GSM5378895","GSM5378911","GSM5378912","GSM5378926","GSM5378945","GSM5378946","GSM5378969","GSM5378970","GSM5379039","GSM5379040","GSM5379064","GSM5379065","GSM5379089","GSM5379090","GSM5379093","GSM5379094",
"GSM5379095","GSM5379106","GSM5379107","GSM5379153","GSM5379154","GSM5379165","GSM5379166","GSM5379227","GSM5379228","GSM5379251","GSM5379252","GSM5379278","GSM5379279","GSM5379313","GSM5379314","GSM5379326","GSM5379327","GSM5379336","GSM5379337","GSM5379338","GSM5379339","GSM5379367","GSM5379368","GSM5379379","GSM5379408","GSM5379409","GSM5379433","GSM5379434","GSM5379435","GSM5379485",
"GSM5379539","GSM5379540","GSM5379550","GSM5379566","GSM5379567","GSM5379579","GSM5379580","GSM5386963","GSM5386965","GSM5386966","GSM5386968","GSM5386969","GSM5386970","GSM5425823","GSM5425825","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/samples/geo_accession")
genes = h5read(destination_file, "meta/genes/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = t(h5read(destination_file, "data/expression", index=list(sample_locations, 1:length(genes))))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE, col.names=NA)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))

