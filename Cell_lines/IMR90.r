# R script to download selected samples
# Copy code and run on a local machine to initiate download

library("rhdf5")    # can be installed using Bioconductor

destination_file = "human_matrix_v10.h5"
extracted_expression_file = "IMR90_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix_v10.h5"

# Check if gene expression file was already downloaded, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE, mode = 'wb')
}

# Selected samples to be extracted
samp = c("GSM973671","GSM973678","GSM973673","GSM973670","GSM1151057","GSM1023654","GSM981244","GSM1023653","GSM1151056","GSM973686","GSM973679","GSM973680","GSM981248","GSM973693","GSM981243","GSM973691","GSM981249","GSM1861914","GSM1861912","GSM2109286","GSM1861968","GSM2109314","GSM1861906","GSM2109289","GSM1861970","GSM2109331","GSM1861905","GSM1553101","GSM1861901","GSM1861967","GSM2109280",
"GSM2109297","GSM2109277","GSM2109317","GSM2109306","GSM2109339","GSM1861915","GSM2109320","GSM1861907","GSM2109298","GSM1289414","GSM2109348","GSM2109291","GSM1861916","GSM1861918","GSM1861897","GSM1861979","GSM2109283","GSM2109273","GSM1553102","GSM1861982","GSM2109337","GSM2109290","GSM1861971","GSM1861908","GSM2109343","GSM1861903","GSM2109325","GSM2109330","GSM2109294","GSM2109276",
"GSM2109315","GSM2109346","GSM2109303","GSM1418973","GSM1861909","GSM1861973","GSM2109345","GSM1861911","GSM2109301","GSM2109312","GSM2109300","GSM2109342","GSM2109338","GSM2109322","GSM2109324","GSM1861895","GSM2109305","GSM2109285","GSM2109311","GSM1861913","GSM1861969","GSM1861985","GSM2109336","GSM2109341","GSM2109272","GSM1861978","GSM2109296","GSM2109293","GSM1269365","GSM1269364",
"GSM1553103","GSM1861983","GSM2109332","GSM1536188","GSM1418974","GSM1861904","GSM1269367","GSM1861900","GSM1861980","GSM2109309","GSM1861975","GSM2109318","GSM1861986","GSM1553105","GSM2109307","GSM1861917","GSM2109271","GSM1861989","GSM2109299","GSM2109327","GSM2109302","GSM2109326","GSM2109335","GSM2109284","GSM1861896","GSM2109304","GSM1861910","GSM2109292","GSM2109313","GSM1861974",
"GSM2109323","GSM1861902","GSM2109316","GSM2109344","GSM2109275","GSM1553104","GSM2109288","GSM1553100","GSM1861976","GSM2109282","GSM1861981","GSM2109340","GSM1289415","GSM2109334","GSM1861987","GSM2109295","GSM1861984","GSM2109319","GSM1861899","GSM2109328","GSM1861977","GSM2109333","GSM2109347","GSM2109279","GSM2109278","GSM2109321","GSM2109310","GSM2109274","GSM1861988","GSM1861972",
"GSM2109281","GSM1917130","GSM1917136","GSM1917144","GSM1917095","GSM1917152","GSM1917146","GSM1917126","GSM1917103","GSM1917092","GSM1917094","GSM1917134","GSM1917096","GSM1325075","GSM1917097","GSM1917124","GSM1917100","GSM1917115","GSM1917129","GSM1917091","GSM1917141","GSM1917142","GSM1917122","GSM1325077","GSM1917089","GSM1917098","GSM1917104","GSM1917086","GSM1687387","GSM1917112",
"GSM1687385","GSM1917131","GSM1325078","GSM1917111","GSM1917135","GSM1917125","GSM1917137","GSM1917150","GSM1917084","GSM1917121","GSM1917087","GSM1917140","GSM2209499","GSM1917119","GSM1917148","GSM1917083","GSM1917132","GSM1917147","GSM1687384","GSM1917139","GSM1917117","GSM1917154","GSM1917099","GSM1917102","GSM1917106","GSM1687386","GSM2209497","GSM1917114","GSM1917113","GSM1917116",
"GSM1917109","GSM1917105","GSM1917110","GSM1917090","GSM1917127","GSM1917143","GSM1917118","GSM1917153","GSM1917088","GSM2209498","GSM1917151","GSM1917138","GSM1917123","GSM1917085","GSM1917145","GSM1917133","GSM1917128","GSM1917108","GSM1917093","GSM1325076","GSM1325074","GSM1325079","GSM1917107","GSM1917120","GSM1917149","GSM1917101","GSM1269366","GSM1861898","GSM1861966","GSM2109329",
"GSM2109308","GSM2109287","GSM2341654","GSM2341655","GSM2341652","GSM2341653","GSM2400216","GSM2400217","GSM2400210","GSM2400211","GSM2400220","GSM979656","GSM979658","GSM979659","GSM2400221","GSM2400223","GSM2400222","GSM2474917","GSM2474918","GSM2474919","GSM2474920","GSM2474921","GSM2474922","GSM2492066","GSM2492067","GSM2492068","GSM2492069","GSM2492070","GSM2492071","GSM2492072",
"GSM2492073","GSM2492074","GSM2492075","GSM2492076","GSM2492077","GSM2492647","GSM2492648","GSM2492649","GSM2492650","GSM2492651","GSM2492654","GSM2492655","GSM2492656","GSM2492657","GSM2492658","GSM2492659","GSM2492660","GSM2492667","GSM2492680","GSM2492684","GSM2492685","GSM2492686","GSM2492687","GSM2492688","GSM2492689","GSM2492690","GSM2492691","GSM2492692","GSM2492693","GSM2492694",
"GSM2492695","GSM2492696","GSM2492697","GSM2492698","GSM2492700","GSM2492701","GSM2492702","GSM2492703","GSM2492704","GSM2492705","GSM2492706","GSM2492707","GSM2492712","GSM2492713","GSM2492719","GSM2492720","GSM2492721","GSM2492722","GSM2492724","GSM2492725","GSM2492726","GSM2492727","GSM2492728","GSM2492729","GSM2492730","GSM2492731","GSM2492732","GSM2492733","GSM2492734","GSM2492735",
"GSM2492736","GSM2492737","GSM2492738","GSM2492739","GSM2492740","GSM2492742","GSM2492743","GSM2492744","GSM2492746","GSM2492747","GSM2492748","GSM2492749","GSM2492750","GSM2492751","GSM2492752","GSM2492753","GSM2492754","GSM2492755","GSM2492756","GSM2492757","GSM2492758","GSM2492759","GSM2492760","GSM2492761","GSM2492762","GSM2492764","GSM2492765","GSM2492767","GSM2492769","GSM2492770",
"GSM2492771","GSM2492772","GSM2492773","GSM2492774","GSM2492775","GSM2492776","GSM2492777","GSM2492778","GSM2492779","GSM2492780","GSM2492781","GSM2492782","GSM2492783","GSM2492785","GSM2492786","GSM2492787","GSM2492788","GSM2492789","GSM2492790","GSM2492791","GSM2492792","GSM2492793","GSM2492794","GSM2492795","GSM2492798","GSM2492800","GSM2492801","GSM2492802","GSM2492803","GSM2492805",
"GSM2492807","GSM2492808","GSM2492809","GSM2492810","GSM2492811","GSM2492813","GSM2492814","GSM2492815","GSM2492816","GSM2492817","GSM2492818","GSM2492819","GSM2492820","GSM2492821","GSM2492822","GSM2492824","GSM2492825","GSM2492826","GSM2492828","GSM2492829","GSM2492830","GSM2492831","GSM2492832","GSM2492833","GSM2492834","GSM2492835","GSM2492836","GSM2492837","GSM2492838","GSM2492840",
"GSM2492841","GSM2492843","GSM2492844","GSM2492845","GSM2492846","GSM2492847","GSM2492848","GSM2492849","GSM2492850","GSM2492851","GSM2492852","GSM2492853","GSM2492854","GSM2492855","GSM2492856","GSM2492857","GSM2492858","GSM2492859","GSM2492860","GSM2492861","GSM2492863","GSM2492864","GSM2492865","GSM2492866","GSM2492867","GSM2492868","GSM2492871","GSM2492872","GSM2492873","GSM2492874",
"GSM2492875","GSM2492876","GSM2492877","GSM2492878","GSM2492879","GSM2492883","GSM2492884","GSM2492885","GSM2492886","GSM2492887","GSM2492888","GSM2492889","GSM2492890","GSM2492891","GSM2492892","GSM2492893","GSM2492894","GSM2492896","GSM2492897","GSM2492898","GSM2492899","GSM2492900","GSM2492901","GSM2492902","GSM2492903","GSM2492904","GSM2492905","GSM2492906","GSM2492908","GSM2492909",
"GSM2492910","GSM2492912","GSM2492915","GSM2492916","GSM2492917","GSM2492919","GSM2492931","GSM2492934","GSM2492935","GSM2492937","GSM2492938","GSM2492939","GSM2492940","GSM2492941","GSM2492942","GSM2492943","GSM2492944","GSM2492945","GSM2492946","GSM2492947","GSM2492948","GSM2492949","GSM2492950","GSM2492955","GSM2492961","GSM2492963","GSM2492964","GSM2492967","GSM2492971","GSM2492972",
"GSM2492973","GSM2492976","GSM2492979","GSM2492980","GSM2492981","GSM2492982","GSM2492983","GSM2492984","GSM2492985","GSM2492988","GSM2492989","GSM2492990","GSM2492992","GSM2492993","GSM2492994","GSM2492995","GSM2493000","GSM2493001","GSM2493002","GSM2493003","GSM2493004","GSM2493005","GSM2493007","GSM2493008","GSM2493009","GSM2493011","GSM2493014","GSM2493016","GSM2493018","GSM2493020",
"GSM2493021","GSM2493022","GSM2493023","GSM2493024","GSM2493030","GSM2493032","GSM2493036","GSM2493037","GSM2493039","GSM2493040","GSM2493041","GSM2493042","GSM2493043","GSM2493046","GSM2493047","GSM2493049","GSM2493061","GSM2493063","GSM2493064","GSM2493065","GSM2493066","GSM2493071","GSM2493072","GSM2493073","GSM2493075","GSM2493076","GSM2493079","GSM2493081","GSM2493083","GSM2493085",
"GSM2493087","GSM2493088","GSM2493091","GSM2493092","GSM2493093","GSM2493094","GSM2493095","GSM2493098","GSM2493099","GSM2493100","GSM2493103","GSM2493105","GSM2493106","GSM2493129","GSM2493130","GSM2493133","GSM2493134","GSM2493135","GSM2493136","GSM2493137","GSM2493138","GSM2493140","GSM2493141","GSM2493142","GSM2493143","GSM2493144","GSM2493147","GSM2493148","GSM2493151","GSM2493152",
"GSM2493155","GSM2493156","GSM2493159","GSM2493160","GSM2493167","GSM2493168","GSM2493169","GSM2493170","GSM2493174","GSM2493178","GSM2493183","GSM2493184","GSM2493193","GSM2493194","GSM2493197","GSM2493198","GSM2493205","GSM2493206","GSM2493207","GSM2493208","GSM2493209","GSM2493210","GSM2493217","GSM2493218","GSM2493219","GSM2493220","GSM2493221","GSM2493222","GSM2493223","GSM2493224",
"GSM2493227","GSM2493228","GSM2493229","GSM2493230","GSM2493232","GSM2493233","GSM2493234","GSM2493235","GSM2493236","GSM2493237","GSM2493238","GSM2493239","GSM2493240","GSM2493242","GSM2493245","GSM2493246","GSM2493247","GSM2493248","GSM2493252","GSM2493254","GSM2493255","GSM2493256","GSM2493262","GSM2493267","GSM2493268","GSM2493271","GSM2493272","GSM2493275","GSM2493276","GSM2493277",
"GSM2493278","GSM2493287","GSM2493288","GSM2493289","GSM2493290","GSM2493293","GSM2493294","GSM2493296","GSM2493297","GSM2493298","GSM2493302","GSM2493303","GSM2493304","GSM2493307","GSM2493308","GSM2493309","GSM2493310","GSM2493311","GSM2493312","GSM2493313","GSM2493314","GSM2493315","GSM2493316","GSM2493317","GSM2493318","GSM2493329","GSM2493330","GSM2493331","GSM2493332","GSM2493333",
"GSM2493334","GSM2493336","GSM2493337","GSM2493338","GSM2493343","GSM2493344","GSM2493346","GSM2493349","GSM2493350","GSM2493351","GSM2493352","GSM2493353","GSM2493354","GSM2493355","GSM2493356","GSM2493361","GSM2493362","GSM2493363","GSM2493364","GSM2493366","GSM2493367","GSM2493368","GSM2493369","GSM2493370","GSM2493371","GSM2493372","GSM2493376","GSM2493378","GSM2493380","GSM2493381",
"GSM2493382","GSM2493387","GSM2493388","GSM2493391","GSM2493392","GSM2493393","GSM2493394","GSM2493396","GSM2493400","GSM2493401","GSM2493402","GSM2493406","GSM2493409","GSM2493410","GSM2493412","GSM2493413","GSM2493414","GSM2493415","GSM2493416","GSM2493420","GSM2493425","GSM2493426","GSM2493428","GSM2493429","GSM2493430","GSM2493435","GSM2493436","GSM2493443","GSM2493444","GSM2493447",
"GSM2493448","GSM2493449","GSM2493450","GSM2493451","GSM2493452","GSM2493453","GSM2493454","GSM2493455","GSM2493456","GSM2493458","GSM2493459","GSM2493460","GSM2493461","GSM2493462","GSM2493471","GSM2493472","GSM2493479","GSM2493480","GSM2493481","GSM2493482","GSM2493483","GSM2493484","GSM2493492","GSM2493496","GSM2493500","GSM2493501","GSM2493502","GSM2493504","GSM2493508","GSM2493509",
"GSM2493510","GSM2493511","GSM2493512","GSM2493513","GSM2493514","GSM2493515","GSM2493516","GSM2493519","GSM2493520","GSM2493521","GSM2493522","GSM2493523","GSM2493524","GSM2493525","GSM2493526","GSM2493527","GSM2493528","GSM2493533","GSM2493534","GSM2493536","GSM2493539","GSM2493540","GSM2493542","GSM2493545","GSM2493546","GSM2493547","GSM2493548","GSM2493557","GSM2493558","GSM2493559",
"GSM2493560","GSM2493561","GSM2493562","GSM2493564","GSM2493568","GSM2493569","GSM2493570","GSM2493571","GSM2493572","GSM2493574","GSM2493576","GSM2493577","GSM2493578","GSM2493580","GSM2493583","GSM2493584","GSM2493585","GSM2493586","GSM2493590","GSM2493592","GSM2493593","GSM2493594","GSM2493598","GSM2493599","GSM2493600","GSM2493602","GSM2493604","GSM2493605","GSM2493606","GSM2493647",
"GSM2493648","GSM2493650","GSM2493652","GSM2493653","GSM2493654","GSM2493655","GSM2493656","GSM2493657","GSM2493658","GSM2493659","GSM2493660","GSM2493661","GSM2493662","GSM2493664","GSM2493665","GSM2493666","GSM2493667","GSM2493668","GSM2493669","GSM2493670","GSM2493671","GSM2493672","GSM2493673","GSM2493674","GSM2493675","GSM2493676","GSM2493677","GSM2493678","GSM2493681","GSM2493682",
"GSM2493684","GSM2493687","GSM2493688","GSM2493691","GSM2493692","GSM2493693","GSM2493694","GSM2493697","GSM2493698","GSM2493700","GSM2493701","GSM2493702","GSM2493705","GSM2493706","GSM2493709","GSM2493710","GSM2493711","GSM2493712","GSM2493713","GSM2493714","GSM2493715","GSM2493716","GSM2493717","GSM2493718","GSM2493719","GSM2493720","GSM2493721","GSM2493722","GSM2493723","GSM2493724",
"GSM2493725","GSM2493726","GSM2494324","GSM2494325","GSM2494326","GSM2494328","GSM2494329","GSM2494330","GSM2494331","GSM2494332","GSM2494333","GSM2494334","GSM2494335","GSM2494336","GSM2494338","GSM2494339","GSM2494340","GSM2494341","GSM2494342","GSM2494343","GSM2494345","GSM2494346","GSM2494347","GSM2494348","GSM2494350","GSM2494351","GSM2494352","GSM2494353","GSM2494354","GSM2494355",
"GSM2494357","GSM2494358","GSM2494359","GSM2494360","GSM2494361","GSM2494362","GSM2494363","GSM2494364","GSM2494365","GSM2494366","GSM2494367","GSM2494368","GSM2494369","GSM2494371","GSM2494372","GSM2494373","GSM2494374","GSM2494375","GSM2494376","GSM2494377","GSM2494380","GSM2494381","GSM2494382","GSM2494383","GSM2494384","GSM2494385","GSM2494386","GSM2494387","GSM2494388","GSM2494389",
"GSM2494390","GSM2494391","GSM2494392","GSM2494393","GSM2494394","GSM2494395","GSM2494397","GSM2494398","GSM2494399","GSM2494400","GSM2494401","GSM2494402","GSM2494403","GSM2494404","GSM2494405","GSM2494406","GSM2494407","GSM2494408","GSM2494409","GSM2494410","GSM2494411","GSM2494412","GSM2494413","GSM2494414","GSM2494415","GSM2494416","GSM2494417","GSM2494418","GSM2494419","GSM2494420",
"GSM2494421","GSM2494422","GSM2494423","GSM2494424","GSM2494425","GSM2494427","GSM2494429","GSM2494430","GSM2494431","GSM2494435","GSM2494438","GSM2494440","GSM2494441","GSM2494442","GSM2494447","GSM2494449","GSM2494450","GSM2494452","GSM2494453","GSM2494454","GSM2494455","GSM2494456","GSM2494457","GSM2494459","GSM2494460","GSM2494462","GSM2494463","GSM2494464","GSM2494465","GSM2494466",
"GSM2494467","GSM2494468","GSM2494469","GSM2494470","GSM2494471","GSM2494472","GSM2494474","GSM2494476","GSM2494477","GSM2494478","GSM2494479","GSM2494480","GSM2494481","GSM2494482","GSM2494483","GSM2494484","GSM2494485","GSM2494486","GSM2494487","GSM2494488","GSM2494489","GSM2494490","GSM2494491","GSM2494493","GSM2494494","GSM2494495","GSM2494496","GSM2494497","GSM2494500","GSM2494505",
"GSM2494506","GSM2494507","GSM2494508","GSM2494511","GSM2494512","GSM2494515","GSM2494516","GSM2494517","GSM2494518","GSM2494519","GSM2494520","GSM2494524","GSM2494525","GSM2494528","GSM2494530","GSM2494533","GSM2494534","GSM2494535","GSM2494537","GSM2494538","GSM2494539","GSM2494540","GSM2494541","GSM2494542","GSM2494543","GSM2494544","GSM2494545","GSM2494546","GSM2494547","GSM2494548",
"GSM2494550","GSM2494551","GSM2494552","GSM2494555","GSM2494556","GSM2494557","GSM2494558","GSM2494559","GSM2494563","GSM2494564","GSM2494565","GSM2494566","GSM2494567","GSM2494568","GSM2494569","GSM2494570","GSM2494571","GSM2494572","GSM2494573","GSM2494574","GSM2494575","GSM2494576","GSM2494577","GSM2494578","GSM2494579","GSM2494580","GSM2494581","GSM2494583","GSM2494585","GSM2494586",
"GSM2494587","GSM2494588","GSM2494589","GSM2494590","GSM2494591","GSM2494595","GSM2494596","GSM2494598","GSM2494601","GSM2494604","GSM2494605","GSM2494606","GSM2494607","GSM2494608","GSM2494609","GSM2494611","GSM2494612","GSM2494613","GSM2494615","GSM2494617","GSM2494618","GSM2494620","GSM2494624","GSM2494626","GSM2494628","GSM2494630","GSM2494632","GSM2494633","GSM2494634","GSM2494635",
"GSM2494636","GSM2494640","GSM2494641","GSM2494644","GSM2494645","GSM2494647","GSM2494648","GSM2494649","GSM2494650","GSM2494651","GSM2494652","GSM2494653","GSM2494654","GSM2494655","GSM2494656","GSM2494657","GSM2494658","GSM2494659","GSM2494660","GSM2494661","GSM2494662","GSM2494663","GSM2494665","GSM2494666","GSM2494667","GSM2494669","GSM2494670","GSM2494672","GSM2494673","GSM2494674",
"GSM2494675","GSM2494676","GSM2494677","GSM2494678","GSM2494679","GSM2494681","GSM2494682","GSM2494683","GSM2494684","GSM2494685","GSM2494686","GSM2494687","GSM2494688","GSM2494689","GSM2494690","GSM2494691","GSM2494692","GSM2494693","GSM2494694","GSM2494695","GSM2494696","GSM2494697","GSM2494698","GSM2494699","GSM2494700","GSM2494701","GSM2494702","GSM2494703","GSM2494704","GSM2494706",
"GSM2494707","GSM2786611","GSM2786612","GSM2786613","GSM2786614","GSM2786615","GSM2786616","GSM2786617","GSM2786618","GSM2786619","GSM2786620","GSM2786621","GSM2786622","GSM2786623","GSM2786624","GSM2786625","GSM2786626","GSM2786627","GSM2786628","GSM2786629","GSM2786630","GSM2786631","GSM2786632","GSM2786633","GSM2786634","GSM2786635","GSM2786636","GSM2786637","GSM2786638","GSM2786639",
"GSM2786640","GSM2786641","GSM2786642","GSM2786643","GSM2786644","GSM2786645","GSM2786646","GSM2786647","GSM2786648","GSM2786649","GSM2786650","GSM2786651","GSM2786652","GSM2786653","GSM2786654","GSM2786655","GSM2067916","GSM2067917","GSM2067918","GSM2067919","GSM2298993","GSM2298994","GSM2630602","GSM2630603","GSM2630604","GSM2630605","GSM2630606","GSM2630607","GSM1682853","GSM1682854",
"GSM1682855","GSM1682856","GSM1682857","GSM3095576","GSM3095577","GSM3095578","GSM3095579","GSM3095580","GSM3095581","GSM3095582","GSM3095583","GSM3095584","GSM3095585","GSM3095586","GSM3095587","GSM3095588","GSM3095589","GSM3095590","GSM3095591","GSM3095592","GSM3095593","GSM3095594","GSM3095595","GSM3095596","GSM3095597","GSM3095598","GSM3095599","GSM2714455","GSM2714457","GSM2714459",
"GSM2714461","GSM2714463","GSM2714465","GSM2714554","GSM2714555","GSM2714557","GSM2714558","GSM2714559","GSM2714561","GSM2714563","GSM2714564","GSM2714863","GSM2714864","GSM2714865","GSM2714868","GSM2714869","GSM2714870","GSM2714871","GSM2714872","GSM2714875","GSM2714876","GSM2714878","GSM2714879","GSM2714880","GSM2714883","GSM2714886","GSM2714887","GSM2714890","GSM2714894","GSM2714897",
"GSM2714902","GSM2714908","GSM2714913","GSM2714914","GSM2714917","GSM2714918","GSM2714923","GSM2714926","GSM2714927","GSM2714928","GSM2714937","GSM2714940","GSM2714943","GSM2714948","GSM2714949","GSM2714950","GSM2714954","GSM2714956","GSM2714957","GSM2714958","GSM2714959","GSM2714962","GSM2714966","GSM2714967","GSM2714970","GSM2714972","GSM2714974","GSM2714975","GSM2714976","GSM2714978",
"GSM2714981","GSM2714982","GSM2714985","GSM2714991","GSM2714992","GSM2714993","GSM2714995","GSM2714996","GSM2714998","GSM2715001","GSM2715003","GSM2715006","GSM2715008","GSM2715009","GSM2715013","GSM2715016","GSM2715018","GSM2715019","GSM2715022","GSM2715024","GSM2715026","GSM2715029","GSM2715032","GSM2715034","GSM2715036","GSM2715038","GSM2715041","GSM2715042","GSM2715044","GSM2715045",
"GSM2715046","GSM2715047","GSM2715048","GSM2715049","GSM2715051","GSM2715053","GSM2715054","GSM2715055","GSM2715056","GSM2715058","GSM2715059","GSM2715062","GSM2715063","GSM2715064","GSM2715065","GSM2715066","GSM2715068","GSM2715070","GSM2715072","GSM2715074","GSM2715075","GSM2715077","GSM2715078","GSM2715080","GSM2715081","GSM2715082","GSM2715084","GSM2715085","GSM2715087","GSM2715089",
"GSM2715091","GSM2715092","GSM2715093","GSM2715095","GSM2715096","GSM2715097","GSM2715098","GSM2715099","GSM2715100","GSM2715101","GSM2715102","GSM2715103","GSM2715104","GSM2715105","GSM2715106","GSM2715107","GSM2715109","GSM2715110","GSM2715111","GSM2715113","GSM2715115","GSM2715116","GSM2715118","GSM2715119","GSM2715120","GSM2715121","GSM2715122","GSM2715123","GSM2715124","GSM2715125",
"GSM2715127","GSM2715128","GSM2715129","GSM2715130","GSM2715131","GSM2715132","GSM2715134","GSM2715135","GSM2715136","GSM2715137","GSM3192177","GSM3192179","GSM3426080","GSM3426081","GSM3426082","GSM3260164","GSM3260165","GSM3260166","GSM3260167","GSM3260168","GSM3260169","GSM3260170","GSM3260171","GSM3260172","GSM3260173","GSM3260174","GSM3260175","GSM3260176","GSM3260177","GSM3260178",
"GSM3260179","GSM3260180","GSM3260181","GSM3174363","GSM3174364","GSM3174365","GSM3174366","GSM3174367","GSM3174368","GSM3174369","GSM3174370","GSM3174371","GSM3174372","GSM3174373","GSM3174374","GSM3174375","GSM3174376","GSM3174377","GSM3174378","GSM3174379","GSM3174380","GSM3174381","GSM3174382","GSM3174383","GSM3174384","GSM3174386","GSM3174388","GSM3174396","GSM3174397","GSM3174401",
"GSM3174403","GSM3174406","GSM3174423","GSM3174424","GSM3174426","GSM3174428","GSM3174429","GSM3174435","GSM3174439","GSM3174441","GSM3174442","GSM3174446","GSM3174449","GSM3174450","GSM3174452","GSM3174453","GSM3174458","GSM3174654","GSM3174655","GSM3174656","GSM3174657","GSM3174658","GSM3174659","GSM3174660","GSM3174661","GSM3174662","GSM3174663","GSM3174664","GSM3174665","GSM3174666",
"GSM3174667","GSM3174668","GSM3174669","GSM3174670","GSM3174671","GSM3174672","GSM3174673","GSM3174674","GSM3174675","GSM3174676","GSM3174677","GSM3174678","GSM3174679","GSM3174680","GSM3174681","GSM3174682","GSM3174683","GSM3174684","GSM3174685","GSM3174686","GSM3174687","GSM3174688","GSM3174689","GSM3174690","GSM3174691","GSM3174692","GSM3174693","GSM3174694","GSM3174695","GSM3174696",
"GSM3174697","GSM3174698","GSM3174699","GSM3174700","GSM3174701","GSM3174702","GSM3174703","GSM3174704","GSM3174705","GSM3174706","GSM3174707","GSM3174708","GSM3174709","GSM3174710","GSM3174711","GSM3174712","GSM3174713","GSM3174714","GSM3174715","GSM3174716","GSM3174717","GSM3174718","GSM3174719","GSM3174720","GSM3174721","GSM3174722","GSM3174723","GSM3174724","GSM3174725","GSM3174726",
"GSM3174727","GSM3174728","GSM3174729","GSM3174730","GSM3174731","GSM3174732","GSM3174733","GSM3174734","GSM3174735","GSM3174736","GSM3174737","GSM3174738","GSM3174739","GSM3174740","GSM3174741","GSM3174742","GSM3174743","GSM3174744","GSM3174745","GSM3174746","GSM3174747","GSM3174748","GSM3174749","GSM3174750","GSM3174751","GSM3174752","GSM3174753","GSM3174754","GSM3174755","GSM3174756",
"GSM3174757","GSM3174758","GSM3174759","GSM3174760","GSM3174761","GSM3174762","GSM3174763","GSM3174764","GSM3174765","GSM3174766","GSM3174767","GSM3174768","GSM3174769","GSM3174770","GSM3174771","GSM3174772","GSM3174773","GSM3174774","GSM3174775","GSM3174776","GSM3174777","GSM3174778","GSM3174779","GSM3174780","GSM3174781","GSM3174782","GSM3174783","GSM3174784","GSM3174785","GSM3174788",
"GSM3174798","GSM3174816","GSM3174821","GSM3174823","GSM3174830","GSM3174839","GSM3174855","GSM3174863","GSM3174865","GSM3174868","GSM3174873","GSM3174874","GSM3174876","GSM3174885","GSM3174886","GSM3174887","GSM3174890","GSM3174907","GSM3174911","GSM3174960","GSM3174966","GSM3174984","GSM3174988","GSM3174989","GSM3174992","GSM3174993","GSM3175001","GSM3175009","GSM3175012","GSM3175023",
"GSM3175028","GSM3175029","GSM3175036","GSM3175039","GSM3175046","GSM3175064","GSM3175089","GSM3175111","GSM3175112","GSM3175122","GSM3684409","GSM3899444","GSM3899445","GSM3899446","GSM3899447","GSM3899448","GSM3899449","GSM3899450","GSM3899451","GSM2894511","GSM2894512","GSM2894513","GSM2894514","GSM2894515","GSM2894516","GSM2894517","GSM2894518","GSM2894519","GSM2894520","GSM2894521",
"GSM2894522","GSM3174462","GSM3174463","GSM3174464","GSM3174465","GSM3174466","GSM3174467","GSM3174468","GSM3174469","GSM3174470","GSM3174471","GSM3174472","GSM3174473","GSM3174474","GSM3174475","GSM3174476","GSM3174477","GSM3174478","GSM3174479","GSM3174480","GSM3174481","GSM3174482","GSM3174483","GSM3174484","GSM3174485","GSM3174486","GSM3174487","GSM3174488","GSM3174489","GSM3174490",
"GSM3174491","GSM3174492","GSM3174493","GSM3174494","GSM3174495","GSM3174496","GSM3174497","GSM3174498","GSM3174499","GSM3174500","GSM3174501","GSM3174502","GSM3174503","GSM3174504","GSM3174505","GSM3174506","GSM3174507","GSM3174508","GSM3174509","GSM3174510","GSM3174511","GSM3174512","GSM3174513","GSM3174514","GSM3174515","GSM3174516","GSM3174517","GSM3174518","GSM3174519","GSM3174520",
"GSM3174521","GSM3174522","GSM3174523","GSM3174524","GSM3174525","GSM3174526","GSM3174527","GSM3174528","GSM3174529","GSM3174530","GSM3174531","GSM3174532","GSM3174533","GSM3174534","GSM3174535","GSM3174536","GSM3174537","GSM3174543","GSM3174546","GSM3174550","GSM3174552","GSM3174569","GSM3174570","GSM3174572","GSM3174578","GSM3174588","GSM3174590","GSM3174601","GSM3174616","GSM3174617",
"GSM3174624","GSM3174636","GSM3174645","GSM3174650","GSM3375551","GSM3375552","GSM3375553","GSM3375554","GSM3375555","GSM3375556","GSM2589108","GSM2589109","GSM2589110","GSM2589111","GSM2589112","GSM2589113","GSM2589114","GSM2589115","GSM2597674","GSM2597675","GSM2597676","GSM2597677","GSM2597678","GSM2597679","GSM2597680","GSM2597681","GSM3914263","GSM3914264","GSM3914265","GSM3914266",
"GSM3914267","GSM3914268","GSM3914269","GSM3914270","GSM3239552","GSM3239553","GSM3239554","GSM3239555","GSM3239556","GSM3239557","GSM3239558","GSM3239559","GSM3239560","GSM3239561","GSM3239562","GSM3239564","GSM3239565","GSM3239566","GSM3239567","GSM3239568","GSM3239569","GSM3239570","GSM3239571","GSM3239572","GSM3239573","GSM3239574","GSM3239575","GSM3239576","GSM3239577","GSM3239578",
"GSM3466454","GSM3466455","GSM3466456","GSM3466457","GSM3861024","GSM3861025","GSM3861026","GSM3861027","GSM3861028","GSM3861029","GSM3861030","GSM3861031","GSM3861032","GSM3861033","GSM3861034","GSM3861035","GSM3861036","GSM3861037","GSM3861038","GSM3861039","GSM3861040","GSM3861041","GSM3861042","GSM3861043","GSM3861044","GSM3861045","GSM3861046","GSM3861047","GSM3861048","GSM3861049",
"GSM3861050","GSM3861051","GSM3861052","GSM3861053","GSM4213729","GSM4213730","GSM4213731","GSM4213732","GSM4735730","GSM4735731","GSM4735732","GSM4735733","GSM4735734","GSM4735735","GSM4735736","GSM4735737","GSM4735738","GSM4735739","GSM4735740","GSM4735741","GSM4832438","GSM4832439","GSM4832440","GSM4832441","GSM4832442","GSM4832443","GSM4832444","GSM4832445","GSM4832446","GSM4832447",
"GSM1006908","GSM1006911","GSM1006913","GSM3475305","GSM3475306","GSM3521079","GSM3521080","GSM3521081","GSM3521082","GSM3521083","GSM3521084","GSM3914262","GSM4323054","GSM4323055","GSM4323056","GSM4323057","GSM4323058","GSM4323059","GSM4323060","GSM4323061","GSM4323062","GSM4323063","GSM4323064","GSM4323065","GSM4323066","GSM4323067","GSM4323068","GSM4323069","GSM4323070","GSM4323071",
"GSM4323072","GSM4323073","GSM4323074","GSM4323075","GSM4323076","GSM4323077","GSM4323078","GSM4323079","GSM4323080","GSM4323081","GSM4323082","GSM4323083","GSM4323084","GSM4323085","GSM4367463","GSM4432374","GSM5014656","GSM5014657","GSM5014658","GSM5014659","GSM5106483","GSM5106484","GSM5106485","GSM5106486","GSM5173727","GSM5173728","GSM5173729","GSM5173730","GSM5234100","GSM5234101",
"GSM5234102","GSM5234111","GSM5234112","GSM5234113","GSM5234114","GSM5234115","GSM5331028","GSM5359974","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/samples/geo_accession")
genes = h5read(destination_file, "meta/genes/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = t(h5read(destination_file, "data/expression", index=list(sample_locations, 1:length(genes))))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE, col.names=NA)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))

