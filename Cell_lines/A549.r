# R script to download selected samples
# Copy code and run on a local machine to initiate download

library("rhdf5")    # can be installed using Bioconductor

destination_file = "human_matrix_v10.h5"
extracted_expression_file = "A549_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix_v10.h5"

# Check if gene expression file was already downloaded, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE, mode = 'wb')
}

# Selected samples to be extracted
samp = c("GSM981246","GSM973683","GSM874648","GSM973669","GSM973661","GSM973674","GSM981247","GSM973684","GSM973664","GSM973668","GSM973685","GSM874649","GSM988513","GSM874647","GSM1678864","GSM2095196","GSM2095194","GSM1678857","GSM1876247","GSM1678860","GSM1678861","GSM1678862","GSM1876246","GSM2095197","GSM2095195","GSM1678858","GSM2300446","GSM1678859","GSM1975081","GSM1624974","GSM2114337",
"GSM1975086","GSM1624973","GSM1246702","GSM2114341","GSM1321439","GSM2114339","GSM1624969","GSM1975084","GSM1624972","GSM1246703","GSM1624971","GSM1975088","GSM1975087","GSM1975085","GSM2114338","GSM1975083","GSM1975089","GSM1975090","GSM1975082","GSM2114344","GSM2114336","GSM2114340","GSM2114342","GSM1370363","GSM2114343","GSM1624970","GSM1678863","GSM1876245","GSM2300447","GSM2400214",
"GSM2400215","GSM2400212","GSM2400213","GSM897083","GSM979632","GSM979633","GSM1367787","GSM1367788","GSM1367785","GSM1367786","GSM1367789","GSM2046133","GSM2046134","GSM2046131","GSM2046132","GSM2310995","GSM2310990","GSM2310993","GSM2310991","GSM2310994","GSM2310989","GSM2310988","GSM2310987","GSM2310992","GSM2406940","GSM2406938","GSM2406939","GSM2406936","GSM2406937","GSM2406943",
"GSM2406942","GSM2406941","GSM2466466","GSM2466459","GSM2466462","GSM2466468","GSM2466464","GSM2466460","GSM2583567","GSM2583566","GSM2583565","GSM2583564","GSM2583563","GSM2583561","GSM2583562","GSM2583560","GSM2421442","GSM2421484","GSM2421514","GSM2421534","GSM2421577","GSM2421617","GSM2421692","GSM2421701","GSM2421759","GSM2421767","GSM2421785","GSM2421933","GSM2685865","GSM2685866",
"GSM2806559","GSM2806560","GSM2806561","GSM2806562","GSM2806563","GSM2806564","GSM2806565","GSM2806566","GSM2806567","GSM2806568","GSM2806569","GSM2806570","GSM2806571","GSM2806572","GSM2806573","GSM2806574","GSM2806575","GSM2806576","GSM2806577","GSM2806578","GSM2806579","GSM2806580","GSM2806581","GSM2806582","GSM2255731","GSM2255732","GSM2255733","GSM2255734","GSM2421441","GSM2421443",
"GSM2421444","GSM2421485","GSM2421486","GSM2421487","GSM2421513","GSM2421515","GSM2421516","GSM2421535","GSM2421536","GSM2421576","GSM2421578","GSM2421579","GSM2421614","GSM2421615","GSM2421616","GSM2421691","GSM2421693","GSM2421700","GSM2421702","GSM2421703","GSM2421757","GSM2421758","GSM2421760","GSM2421764","GSM2421765","GSM2421766","GSM2421783","GSM2421784","GSM2421786","GSM2421932",
"GSM2421934","GSM2421935","GSM2640632","GSM2640633","GSM2640634","GSM2640635","GSM2640636","GSM2640637","GSM2640638","GSM2640639","GSM2640640","GSM2640641","GSM2640642","GSM2640643","GSM2714729","GSM2714731","GSM2714734","GSM2714736","GSM2717392","GSM2717393","GSM2717394","GSM2717395","GSM2717396","GSM2717397","GSM1599488","GSM1599489","GSM2902357","GSM2902358","GSM2902359","GSM2902360",
"GSM2902361","GSM2902362","GSM2424466","GSM2424467","GSM2424468","GSM2424469","GSM2424470","GSM2752555","GSM2752556","GSM2752557","GSM2752558","GSM2752559","GSM2752560","GSM2791023","GSM2791024","GSM2791025","GSM2791026","GSM2791027","GSM2791028","GSM2791029","GSM2791030","GSM2791031","GSM2791032","GSM2791033","GSM2791034","GSM2791035","GSM2791036","GSM2791037","GSM2791038","GSM2791039",
"GSM2791040","GSM2791041","GSM2791042","GSM2791043","GSM2791044","GSM2791045","GSM2791046","GSM2791047","GSM2791048","GSM2791049","GSM2791050","GSM2791051","GSM2791052","GSM1700944","GSM1700945","GSM1700946","GSM1700947","GSM1955398","GSM1955399","GSM1955400","GSM1955401","GSM1955402","GSM1955403","GSM1955404","GSM1955405","GSM2257959","GSM2257960","GSM2257961","GSM2257962","GSM2478935",
"GSM2478936","GSM2478937","GSM2478938","GSM2478939","GSM2478940","GSM2478941","GSM2478942","GSM2478943","GSM2478944","GSM2478945","GSM2478946","GSM2537176","GSM2537177","GSM2537178","GSM2537179","GSM2537180","GSM2537181","GSM2537182","GSM2537183","GSM2537184","GSM2537185","GSM2537186","GSM2537187","GSM2830949","GSM2830950","GSM2830951","GSM2830952","GSM2830953","GSM2830954","GSM2830955",
"GSM2830956","GSM2830957","GSM3097016","GSM3097017","GSM3097018","GSM2759912","GSM2759913","GSM2759914","GSM2759915","GSM2230822","GSM2230823","GSM2230824","GSM2230825","GSM2230826","GSM2230827","GSM2230828","GSM2230829","GSM2230830","GSM2230831","GSM2230832","GSM2230833","GSM3108331","GSM3108332","GSM3108333","GSM3108334","GSM3108335","GSM3108336","GSM3146283","GSM3146284","GSM3146285",
"GSM3146286","GSM2677395","GSM2677407","GSM2875647","GSM2875648","GSM2915861","GSM2915862","GSM3397284","GSM3397285","GSM3397286","GSM3397287","GSM3397288","GSM3397289","GSM3397290","GSM3397291","GSM3397292","GSM3397293","GSM3397294","GSM3397295","GSM3397296","GSM3397297","GSM3397298","GSM3397299","GSM3427037","GSM3427038","GSM3427039","GSM3427040","GSM3427041","GSM3427042","GSM3359581",
"GSM3359583","GSM3359584","GSM3359585","GSM3359586","GSM3449683","GSM3449684","GSM3449685","GSM3449686","GSM3449687","GSM3449688","GSM3531991","GSM3531992","GSM3531993","GSM3531994","GSM3531995","GSM3531996","GSM3531997","GSM3531998","GSM3531999","GSM2300611","GSM2300612","GSM2300613","GSM2300614","GSM3176551","GSM3176552","GSM3176553","GSM3176554","GSM3176555","GSM3176556","GSM3494225",
"GSM3494226","GSM3494227","GSM3494228","GSM3494229","GSM3572736","GSM3572737","GSM3572738","GSM3572739","GSM2878386","GSM2878387","GSM2878388","GSM2878389","GSM2878390","GSM2878391","GSM2878392","GSM2878393","GSM2878394","GSM2878395","GSM2878396","GSM2878397","GSM2878398","GSM2878399","GSM2878400","GSM2878401","GSM2878402","GSM2878403","GSM2878404","GSM2878405","GSM2878406","GSM2878407",
"GSM2878408","GSM2878409","GSM2878410","GSM2878411","GSM2878412","GSM2878413","GSM3615703","GSM3615704","GSM3615705","GSM3615706","GSM3395498","GSM3395499","GSM3395500","GSM3395501","GSM3395502","GSM3395503","GSM3395504","GSM3395505","GSM3395506","GSM3395507","GSM3395508","GSM3395509","GSM3395510","GSM3395511","GSM3395512","GSM3395513","GSM3395514","GSM3395515","GSM3395516","GSM3395517",
"GSM3395518","GSM3395519","GSM3395520","GSM3395521","GSM3395522","GSM3395523","GSM3688330","GSM3688331","GSM3688332","GSM3900214","GSM3900215","GSM3900216","GSM3900217","GSM3900218","GSM3900219","GSM4183297","GSM4183298","GSM4059893","GSM4059894","GSM4059895","GSM4059896","GSM4059897","GSM4059898","GSM4059899","GSM4059900","GSM4059901","GSM4059902","GSM4059903","GSM4059904","GSM4059905",
"GSM4059906","GSM4059907","GSM4059908","GSM4059909","GSM4161235","GSM4161236","GSM4161237","GSM4161238","GSM4161239","GSM4161240","GSM4161241","GSM4161242","GSM4161243","GSM4161244","GSM4161245","GSM4161246","GSM4161247","GSM4161248","GSM4161249","GSM4161250","GSM4161251","GSM4161252","GSM4161253","GSM4161254","GSM4161255","GSM4161256","GSM4161257","GSM4161258","GSM4120282","GSM4120283",
"GSM4120284","GSM4120285","GSM2097523","GSM3335840","GSM3335841","GSM3335842","GSM3335843","GSM3335844","GSM3335845","GSM4156897","GSM4156898","GSM3931406","GSM3931407","GSM2232905","GSM2741635","GSM2741636","GSM2741637","GSM2741638","GSM3538194","GSM3538195","GSM3538196","GSM3538197","GSM3538198","GSM3538199","GSM3538200","GSM3538201","GSM3538202","GSM3538203","GSM3538204","GSM3538205",
"GSM3538206","GSM3538207","GSM3538208","GSM3538209","GSM3538210","GSM3538211","GSM3538212","GSM3538213","GSM3538214","GSM3538215","GSM3538216","GSM3538217","GSM3771336","GSM3771337","GSM3771338","GSM3771339","GSM3771340","GSM3771341","GSM3771342","GSM3771343","GSM3771344","GSM3771345","GSM3771346","GSM3772912","GSM3772913","GSM3772914","GSM3772915","GSM3863102","GSM3863103","GSM3898638",
"GSM3898639","GSM3898640","GSM3898641","GSM3898642","GSM3898643","GSM3898644","GSM3898645","GSM3898646","GSM3898647","GSM3898648","GSM3898649","GSM4080780","GSM4080781","GSM4215507","GSM4215508","GSM4232997","GSM4232998","GSM4232999","GSM4233000","GSM4233001","GSM4233002","GSM4233003","GSM4233004","GSM4233005","GSM4233006","GSM4233007","GSM4233008","GSM4233009","GSM4233010","GSM4233011",
"GSM4233012","GSM4233013","GSM4233014","GSM4233015","GSM4233016","GSM4233017","GSM4233018","GSM4233019","GSM4233020","GSM4233021","GSM4233022","GSM4233023","GSM4233024","GSM4233025","GSM4233026","GSM4233027","GSM4233028","GSM4233029","GSM4233030","GSM4233031","GSM4233032","GSM4237719","GSM4237720","GSM4250945","GSM4250946","GSM4250947","GSM4250948","GSM4250949","GSM4250950","GSM4250951",
"GSM4250952","GSM4250953","GSM4250954","GSM4250955","GSM4250956","GSM4271146","GSM4271147","GSM4271148","GSM4271149","GSM4271150","GSM4271151","GSM4271152","GSM4271153","GSM4272682","GSM4272683","GSM4286769","GSM4317437","GSM4317438","GSM4317439","GSM4317440","GSM4317441","GSM4317442","GSM4317443","GSM4317444","GSM4384763","GSM4384764","GSM4384766","GSM4384767","GSM4384768","GSM4384769",
"GSM4384770","GSM4384771","GSM4384772","GSM4384773","GSM4384774","GSM4384775","GSM4384776","GSM4384777","GSM4384778","GSM4384779","GSM4384780","GSM4384781","GSM4384782","GSM4384783","GSM4384784","GSM4384785","GSM4384786","GSM4384787","GSM4384788","GSM4384789","GSM4384790","GSM4384791","GSM4384792","GSM4384793","GSM4384794","GSM4384795","GSM4384796","GSM4384797","GSM4384798","GSM4384799",
"GSM4384800","GSM4384801","GSM4384802","GSM4384803","GSM4384804","GSM4384805","GSM4384806","GSM4384808","GSM4384809","GSM4384810","GSM4384811","GSM4384812","GSM4384813","GSM4384814","GSM4384816","GSM4385296","GSM4385297","GSM4385298","GSM4385299","GSM4385300","GSM4385301","GSM4421217","GSM4421218","GSM4421219","GSM4421220","GSM4432384","GSM4432385","GSM4432386","GSM4432387","GSM4432388",
"GSM4432389","GSM4432390","GSM4432391","GSM4432392","GSM4432393","GSM4432394","GSM4432395","GSM4432396","GSM4432397","GSM4462336","GSM4462337","GSM4462338","GSM4462339","GSM4462340","GSM4462341","GSM4462342","GSM4462343","GSM4462344","GSM4462345","GSM4462346","GSM4462347","GSM4462354","GSM4462355","GSM4462356","GSM4462357","GSM4462358","GSM4462359","GSM4462360","GSM4462361","GSM4462362",
"GSM4486157","GSM4486158","GSM4486159","GSM4486160","GSM4486161","GSM4486162","GSM4486163","GSM4486164","GSM4486165","GSM4559202","GSM4559203","GSM4559204","GSM4568476","GSM4568477","GSM4568478","GSM4568479","GSM4568480","GSM4568481","GSM4568482","GSM4568483","GSM4568484","GSM4640673","GSM4640674","GSM4640675","GSM4640676","GSM4640677","GSM4640678","GSM4647024","GSM4647025","GSM4675213",
"GSM4675214","GSM4675215","GSM4675216","GSM4675217","GSM4675218","GSM4675220","GSM4675221","GSM4675222","GSM4675223","GSM4675224","GSM4675225","GSM4675226","GSM4675227","GSM4675228","GSM4675229","GSM4675231","GSM4675232","GSM4675233","GSM4675235","GSM4675236","GSM4675760","GSM4675761","GSM4675762","GSM4675763","GSM4675764","GSM4675765","GSM4675766","GSM4675767","GSM4675768","GSM4675769",
"GSM4675770","GSM4675771","GSM4675772","GSM4675773","GSM4675774","GSM4675775","GSM4675776","GSM4675777","GSM4675778","GSM4675779","GSM4675780","GSM4675781","GSM4675782","GSM4675783","GSM4675784","GSM4675785","GSM4675786","GSM4675787","GSM4675788","GSM4675789","GSM4675790","GSM4675791","GSM4675792","GSM4675793","GSM4675794","GSM4675795","GSM4675796","GSM4675797","GSM4675798","GSM4675799",
"GSM4675800","GSM4675801","GSM4734669","GSM4734670","GSM4734671","GSM4734672","GSM4734673","GSM4734674","GSM4735052","GSM4735053","GSM4735054","GSM4735055","GSM4735056","GSM4735057","GSM4735058","GSM4735059","GSM4735060","GSM4735061","GSM4735062","GSM4735063","GSM4771575","GSM4771576","GSM4771577","GSM4771579","GSM4771580","GSM3151238","GSM3151239","GSM3349043","GSM3349044","GSM3349045",
"GSM3349046","GSM3674108","GSM3674109","GSM3674110","GSM3674111","GSM3674112","GSM3674113","GSM3674114","GSM3674115","GSM3729207","GSM3729208","GSM3729209","GSM3729210","GSM3729211","GSM3729212","GSM4150377","GSM4150378","GSM4150379","GSM4196000","GSM4196001","GSM4196002","GSM4196003","GSM4196004","GSM4196005","GSM4196006","GSM4196007","GSM4196008","GSM4196009","GSM4213496","GSM4213497",
"GSM4213498","GSM4213499","GSM4213500","GSM4213501","GSM4213502","GSM4213503","GSM4213504","GSM4213505","GSM4213506","GSM4213507","GSM4213508","GSM4213509","GSM4213510","GSM4213511","GSM4213512","GSM4213513","GSM4213514","GSM4213515","GSM4213516","GSM4213517","GSM4213518","GSM4213519","GSM4213520","GSM4213521","GSM4213522","GSM4213523","GSM4213524","GSM4213525","GSM4213526","GSM4213527",
"GSM4213528","GSM4230516","GSM4230517","GSM4230518","GSM4230519","GSM4230520","GSM4230521","GSM4230522","GSM4230523","GSM4230524","GSM4230525","GSM4230526","GSM4230527","GSM4230528","GSM4230529","GSM4230530","GSM4384765","GSM4384807","GSM4384815","GSM4411729","GSM4411730","GSM4411731","GSM4411732","GSM4411733","GSM4411734","GSM4411735","GSM4411736","GSM4411737","GSM4411738","GSM4411739",
"GSM4411740","GSM4421221","GSM4421222","GSM4421223","GSM4421224","GSM4421225","GSM4421226","GSM4421227","GSM4421228","GSM4421229","GSM4421230","GSM4446734","GSM4446735","GSM4446736","GSM4446737","GSM4446738","GSM4446739","GSM4446740","GSM4446741","GSM4446742","GSM4446743","GSM4446744","GSM4446745","GSM4446746","GSM4446747","GSM4446748","GSM4446749","GSM4446750","GSM4446751","GSM4446752",
"GSM4446753","GSM4446754","GSM4446755","GSM4446756","GSM4446757","GSM4446758","GSM4446759","GSM4446760","GSM4446761","GSM4446762","GSM4446763","GSM4446764","GSM4446765","GSM4446766","GSM4446767","GSM4446768","GSM4446769","GSM4446770","GSM4446771","GSM4446772","GSM4446773","GSM4446774","GSM4446775","GSM4446776","GSM4446777","GSM4446778","GSM4446779","GSM4446780","GSM4446781","GSM4446782",
"GSM4446783","GSM4446784","GSM4446785","GSM4446786","GSM4446787","GSM4446788","GSM4446789","GSM4446790","GSM4446791","GSM4446792","GSM4446793","GSM4446794","GSM4446795","GSM4446796","GSM4446797","GSM4446798","GSM4446799","GSM4446800","GSM4446801","GSM4446802","GSM4446803","GSM4446804","GSM4446805","GSM4446806","GSM4446807","GSM4446808","GSM4446809","GSM4446810","GSM4446811","GSM4446812",
"GSM4446813","GSM4446814","GSM4446815","GSM4446816","GSM4446817","GSM4446818","GSM4446819","GSM4446820","GSM4446821","GSM4446822","GSM4446823","GSM4446824","GSM4446825","GSM4446826","GSM4446827","GSM4446828","GSM4446829","GSM4446830","GSM4446831","GSM4446832","GSM4446833","GSM4446834","GSM4446836","GSM4446837","GSM4446838","GSM4446839","GSM4446840","GSM4446841","GSM4446842","GSM4446843",
"GSM4446844","GSM4446845","GSM4446846","GSM4446847","GSM4474578","GSM4474579","GSM4474580","GSM4474581","GSM4504424","GSM4504425","GSM4504426","GSM4504427","GSM4504428","GSM4504429","GSM4504430","GSM4504431","GSM4504432","GSM4504433","GSM4504434","GSM4504435","GSM4675230","GSM4704964","GSM4704965","GSM4704966","GSM4704967","GSM4704968","GSM4704969","GSM4716577","GSM4716578","GSM4716579",
"GSM4716580","GSM4716581","GSM4716582","GSM4716583","GSM4716584","GSM4716585","GSM4716586","GSM4716587","GSM4716588","GSM4721548","GSM4721549","GSM4721550","GSM4721551","GSM4721552","GSM4721553","GSM4721554","GSM4721555","GSM4721556","GSM4721557","GSM4721558","GSM4721559","GSM4749754","GSM4749755","GSM4771574","GSM4771578","GSM4771581","GSM4804879","GSM4804880","GSM4822344","GSM4831766",
"GSM4831767","GSM4831768","GSM4831769","GSM4831770","GSM4831771","GSM4831772","GSM4831773","GSM4831774","GSM4831775","GSM4831776","GSM4831777","GSM4957765","GSM4957766","GSM4957767","GSM4978207","GSM4978208","GSM4978209","GSM1006902","GSM1006903","GSM1006909","GSM2640697","GSM2640698","GSM2640699","GSM2640700","GSM2640701","GSM2640702","GSM2640703","GSM2640704","GSM3212804","GSM3212805",
"GSM3212815","GSM3212816","GSM3324745","GSM3324746","GSM3324747","GSM3324748","GSM3359582","GSM3405948","GSM3405949","GSM3405950","GSM3895060","GSM3895061","GSM3895062","GSM3895063","GSM3895696","GSM3895697","GSM3931438","GSM3931439","GSM3931440","GSM3931441","GSM4061724","GSM4061725","GSM4067013","GSM4067014","GSM4094671","GSM4094672","GSM4094674","GSM4094675","GSM4094677","GSM4094678",
"GSM4094679","GSM4094680","GSM4117261","GSM4117263","GSM4292974","GSM4292976","GSM4292977","GSM4292978","GSM4292979","GSM4292984","GSM4292985","GSM4292993","GSM4292995","GSM4292996","GSM4292997","GSM4292999","GSM4293004","GSM4293005","GSM4293007","GSM4293014","GSM4293015","GSM4293016","GSM4293020","GSM4293021","GSM4293022","GSM4293023","GSM4293025","GSM4293026","GSM4293027","GSM4293028",
"GSM4293029","GSM4293031","GSM4293036","GSM4293037","GSM4293043","GSM4293046","GSM4293047","GSM4293050","GSM4293051","GSM4293052","GSM4293054","GSM4293055","GSM4293058","GSM4293059","GSM4293060","GSM4293062","GSM4293064","GSM4293065","GSM4293068","GSM4293069","GSM4293070","GSM4293072","GSM4293076","GSM4293077","GSM4293080","GSM4293081","GSM4293082","GSM4293083","GSM4293085","GSM4293086",
"GSM4293087","GSM4293090","GSM4293091","GSM4293093","GSM4293095","GSM4293096","GSM4293097","GSM4293098","GSM4293102","GSM4293103","GSM4293105","GSM4293106","GSM4293107","GSM4293109","GSM4293110","GSM4293111","GSM4293114","GSM4293115","GSM4293116","GSM4293118","GSM4293119","GSM4293120","GSM4293121","GSM4293123","GSM4293124","GSM4293125","GSM4293126","GSM4293127","GSM4293129","GSM4293132",
"GSM4293134","GSM4293135","GSM4293169","GSM4293170","GSM4293172","GSM4293173","GSM4293174","GSM4293175","GSM4293176","GSM4293178","GSM4293179","GSM4293180","GSM4293181","GSM4293182","GSM4293183","GSM4293184","GSM4293186","GSM4293187","GSM4293188","GSM4293190","GSM4293191","GSM4293192","GSM4293193","GSM4293194","GSM4293195","GSM4293197","GSM4293198","GSM4293202","GSM4293203","GSM4293204",
"GSM4306646","GSM4306647","GSM4399552","GSM4399553","GSM4399554","GSM4399556","GSM4399557","GSM4399558","GSM4399559","GSM4399560","GSM4399561","GSM4399562","GSM4399563","GSM4473221","GSM4473222","GSM4473223","GSM4473225","GSM4473226","GSM4673206","GSM4673207","GSM4673208","GSM4673209","GSM4673210","GSM4673212","GSM4673213","GSM4673214","GSM4673215","GSM4673217","GSM4728478","GSM4728479",
"GSM4728480","GSM4728481","GSM4773808","GSM4773809","GSM4773810","GSM4773811","GSM4946175","GSM4946176","GSM4946177","GSM4946178","GSM4946179","GSM4946180","GSM4948370","GSM4948371","GSM4955401","GSM4955402","GSM4955403","GSM4955404","GSM4955405","GSM4955406","GSM4955407","GSM4955408","GSM4955409","GSM4955410","GSM4955411","GSM4955412","GSM4955413","GSM4955414","GSM4955415","GSM4955416",
"GSM4955417","GSM4955418","GSM5025918","GSM5025919","GSM5031744","GSM5031745","GSM5031746","GSM5031747","GSM5031748","GSM5031749","GSM5031750","GSM5031751","GSM5031752","GSM5031753","GSM5031754","GSM5031755","GSM5031756","GSM5031757","GSM5031758","GSM5031759","GSM5031760","GSM5031761","GSM5031762","GSM5031763","GSM5031764","GSM5031765","GSM5031766","GSM5031767","GSM5031768","GSM5031769",
"GSM5031770","GSM5057649","GSM5059635","GSM5059636","GSM5059637","GSM5059638","GSM5059639","GSM5059640","GSM5113841","GSM5113842","GSM5113844","GSM5113845","GSM5113846","GSM5113847","GSM5113848","GSM5113849","GSM5113850","GSM5113852","GSM5113853","GSM5113856","GSM5113857","GSM5113858","GSM5113859","GSM5113860","GSM5113861","GSM5113862","GSM5113863","GSM5113864","GSM5176803","GSM5176804",
"GSM5176805","GSM5231210","GSM5231211","GSM5231212","GSM5252412","GSM5283415","GSM5283416","GSM5283417","GSM5283420","GSM5283421","GSM5374167","GSM5374168","GSM5374169","GSM5374657","GSM5375516","GSM5375517","GSM5375518","GSM5379129","GSM5379138","GSM5379139","GSM5379140","GSM5379323","GSM5379324","GSM5379325","GSM5401622","GSM5401626","GSM5401627","GSM5401628","GSM5401629","GSM5401661",
"GSM5401662","GSM5401663","GSM5401664","GSM5401665","GSM5401666","GSM5401667","GSM5401668","GSM5430467","GSM5430468","GSM5430470","GSM5430471","GSM5430472","GSM5437368","GSM5437369","GSM5437370","GSM5468842","GSM5471859","GSM5471860","GSM5471861","GSM5471862","GSM5471863","GSM5471865","GSM5471866","GSM5512617","GSM5512618","GSM5512619","GSM5512620","GSM5512621","GSM5512623","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/samples/geo_accession")
genes = h5read(destination_file, "meta/genes/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = t(h5read(destination_file, "data/expression", index=list(sample_locations, 1:length(genes))))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE, col.names=NA)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))

