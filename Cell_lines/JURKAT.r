# R script to download selected samples
# Copy code and run on a local machine to initiate download

library("rhdf5")    # can be installed using Bioconductor

destination_file = "human_matrix_v10.h5"
extracted_expression_file = "JURKAT_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix_v10.h5"

# Check if gene expression file was already downloaded, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE, mode = 'wb')
}

# Selected samples to be extracted
samp = c("GSM1097789","GSM1859760","GSM1859768","GSM1859769","GSM2300702","GSM1859764","GSM1859763","GSM1859761","GSM1859767","GSM1859762","GSM1859770","GSM2300701","GSM1859765","GSM1859766","GSM1833455","GSM1833443","GSM1833451","GSM1833456","GSM1833447","GSM1833445","GSM1833450","GSM1833457","GSM1833448","GSM1833436","GSM1833460","GSM1833437","GSM1833444","GSM1833449","GSM1833453","GSM1833459","GSM1833458",
"GSM1833434","GSM1833435","GSM1833438","GSM1833439","GSM1833454","GSM1833441","GSM1833433","GSM1833446","GSM1833442","GSM1833452","GSM1859759","GSM1702298","GSM1702299","GSM2171783","GSM1702302","GSM1702300","GSM1702301","GSM1702295","GSM1702296","GSM1702297","GSM2411141","GSM2411142","GSM2411143","GSM2411144","GSM2411145","GSM2411146","GSM2411147","GSM2411148","GSM2411149","GSM2411150",
"GSM2411151","GSM2411152","GSM2411153","GSM2411154","GSM2411155","GSM2785196","GSM2785197","GSM2785198","GSM2785199","GSM2785200","GSM2785201","GSM2785202","GSM2785203","GSM2785204","GSM2785205","GSM2785206","GSM2785207","GSM2785208","GSM2785209","GSM2785210","GSM2785211","GSM2785212","GSM2785213","GSM1694097","GSM1694098","GSM2796761","GSM2796762","GSM2796763","GSM2796764","GSM2943809",
"GSM2943810","GSM2943811","GSM2943812","GSM2943813","GSM2943814","GSM2943815","GSM2943816","GSM2439091","GSM2439092","GSM2439093","GSM2439094","GSM2439095","GSM2439096","GSM2439097","GSM2439098","GSM2439099","GSM2439100","GSM2439101","GSM2439102","GSM2439103","GSM2439104","GSM2439105","GSM2439106","GSM2439107","GSM2439108","GSM2439109","GSM2439110","GSM2439111","GSM2439112","GSM2439113",
"GSM2439114","GSM2439115","GSM2439116","GSM2439117","GSM2439118","GSM2439119","GSM2439120","GSM2439121","GSM2439122","GSM2439123","GSM2439124","GSM2439125","GSM2439126","GSM2439127","GSM2439128","GSM2439129","GSM2439130","GSM2439131","GSM2439132","GSM2439133","GSM2439134","GSM2439135","GSM2439136","GSM2439137","GSM2439138","GSM2439139","GSM2439140","GSM2439141","GSM2439142","GSM2439143",
"GSM2439144","GSM2439145","GSM2439146","GSM2439147","GSM2439148","GSM2439149","GSM2439150","GSM2439151","GSM2439152","GSM2439153","GSM2439154","GSM2439155","GSM2439156","GSM2439157","GSM2439158","GSM2439159","GSM2439160","GSM2439161","GSM2439162","GSM2439163","GSM2439164","GSM2439165","GSM2439166","GSM2439167","GSM2439168","GSM2439169","GSM2439170","GSM2439171","GSM2439172","GSM2439173",
"GSM2439174","GSM2439175","GSM2439176","GSM2439177","GSM2570508","GSM2570509","GSM2570510","GSM2570511","GSM2570512","GSM2570513","GSM2570514","GSM2570515","GSM2570516","GSM2570517","GSM2570518","GSM2570519","GSM2570520","GSM2570521","GSM2570522","GSM2570523","GSM2570524","GSM2570525","GSM2753018","GSM2793975","GSM2793976","GSM2793977","GSM2793978","GSM2363370","GSM2363371","GSM2363372",
"GSM2363373","GSM2363374","GSM2363375","GSM3024556","GSM3024557","GSM3024558","GSM3024559","GSM3024560","GSM3024561","GSM3024562","GSM3024563","GSM3024564","GSM3024565","GSM3024566","GSM2680622","GSM2680623","GSM2680624","GSM2680625","GSM2826274","GSM2826275","GSM2826277","GSM2826278","GSM2826280","GSM2826282","GSM2826284","GSM2826286","GSM2826287","GSM2826289","GSM2826291","GSM2826509",
"GSM2826510","GSM2826511","GSM2826512","GSM2826513","GSM2826514","GSM2826515","GSM2826516","GSM2826517","GSM2826518","GSM2826519","GSM2826520","GSM2826521","GSM2826522","GSM2826523","GSM2826524","GSM2826525","GSM2826526","GSM2826527","GSM2826529","GSM2826530","GSM2826531","GSM2826532","GSM2826533","GSM2826534","GSM2826535","GSM2826536","GSM2826537","GSM2826538","GSM2826539","GSM2826540",
"GSM2826541","GSM2826542","GSM2826543","GSM2826544","GSM2826545","GSM2826546","GSM2826547","GSM2826548","GSM2826549","GSM2826550","GSM2826551","GSM2826552","GSM2826554","GSM2826555","GSM2915468","GSM2915469","GSM2915470","GSM2915471","GSM2915472","GSM2915473","GSM2915474","GSM2915475","GSM2915476","GSM2915477","GSM2915478","GSM2915479","GSM2916255","GSM2916256","GSM2916257","GSM2916258",
"GSM2916259","GSM2916260","GSM2916261","GSM2916262","GSM2916263","GSM2995218","GSM2995219","GSM2995220","GSM2995221","GSM2995222","GSM2995223","GSM3612801","GSM3612802","GSM3612803","GSM3612804","GSM3612805","GSM3612806","GSM3612807","GSM3612808","GSM3612809","GSM3612810","GSM3612811","GSM3612812","GSM3204347","GSM3204348","GSM3057114","GSM3057115","GSM3057116","GSM3057117","GSM3450587",
"GSM3450588","GSM3450589","GSM3450590","GSM3450591","GSM3450592","GSM3450593","GSM3450594","GSM3450595","GSM3450596","GSM3450597","GSM3450598","GSM3703348","GSM3703349","GSM3703350","GSM3703351","GSM3703352","GSM3703353","GSM3703354","GSM3703355","GSM3703356","GSM3703357","GSM3703358","GSM3703359","GSM3703360","GSM3703361","GSM3946025","GSM3946026","GSM3946027","GSM3946028","GSM3946029",
"GSM3946030","GSM3946031","GSM3946032","GSM3946033","GSM3946034","GSM3946035","GSM3946036","GSM3946037","GSM3946038","GSM4081707","GSM4081708","GSM3669806","GSM3669808","GSM3669809","GSM3669810","GSM3669811","GSM3669812","GSM3669813","GSM3669815","GSM3669816","GSM3669817","GSM3669818","GSM3669819","GSM3669821","GSM3669823","GSM3669824","GSM3669825","GSM3669826","GSM3669827","GSM3669828",
"GSM3669829","GSM3669830","GSM3669831","GSM3669832","GSM3669834","GSM3669835","GSM3669836","GSM3669837","GSM3669838","GSM3669839","GSM3669840","GSM3669841","GSM3669843","GSM3669846","GSM3669847","GSM3669848","GSM3669849","GSM3669850","GSM3669851","GSM3669852","GSM3669853","GSM3669855","GSM3669856","GSM3669857","GSM3669858","GSM3669859","GSM3669861","GSM3669863","GSM3669864","GSM3669865",
"GSM3669867","GSM3669868","GSM3669870","GSM3669871","GSM3669872","GSM3669873","GSM3669874","GSM3669876","GSM3669880","GSM3669884","GSM3669885","GSM3669886","GSM3669887","GSM3669888","GSM3669889","GSM3669890","GSM3669891","GSM3669892","GSM3669893","GSM3669895","GSM3669897","GSM3669899","GSM3669900","GSM3669901","GSM3669902","GSM3669903","GSM3669904","GSM3669905","GSM3669906","GSM3669908",
"GSM3669909","GSM3669910","GSM3669911","GSM3669912","GSM3669913","GSM3669914","GSM3669915","GSM3669916","GSM3669917","GSM3669918","GSM3669919","GSM3669920","GSM3669922","GSM3669923","GSM3669924","GSM3669925","GSM3669926","GSM3669927","GSM3669928","GSM3669929","GSM3669930","GSM3669931","GSM3669932","GSM3669933","GSM3669934","GSM3669936","GSM3669937","GSM3669938","GSM3669939","GSM3669940",
"GSM3669941","GSM3669942","GSM3669944","GSM3669945","GSM3669946","GSM3669947","GSM3669948","GSM3669949","GSM3669950","GSM3669951","GSM3669952","GSM3669953","GSM3669954","GSM3669955","GSM3669956","GSM3669957","GSM3669958","GSM3669959","GSM3669960","GSM3669961","GSM3669962","GSM3669963","GSM3669964","GSM3669965","GSM3669966","GSM3669967","GSM3669968","GSM3669969","GSM3669970","GSM3669971",
"GSM3669972","GSM3669973","GSM3669974","GSM3669976","GSM3669977","GSM3669978","GSM3669980","GSM3669981","GSM3669982","GSM3669983","GSM3669984","GSM3669985","GSM3669987","GSM3669988","GSM3669989","GSM3669990","GSM3669991","GSM3669992","GSM3669995","GSM3669997","GSM3670000","GSM3670002","GSM3670005","GSM3670008","GSM3670009","GSM3670010","GSM3670011","GSM3670012","GSM3670013","GSM3670014",
"GSM3670015","GSM3670016","GSM3670017","GSM3670018","GSM3670019","GSM3670020","GSM3670021","GSM3670022","GSM3670023","GSM3670024","GSM3670025","GSM3670026","GSM3670027","GSM3670028","GSM3670029","GSM3670030","GSM3670031","GSM3670032","GSM3670033","GSM3670034","GSM3670035","GSM3670038","GSM3670040","GSM3670043","GSM3670046","GSM3670048","GSM3670051","GSM3670053","GSM3670056","GSM3670059",
"GSM3670061","GSM3670064","GSM3670067","GSM3670068","GSM3670069","GSM3670070","GSM3670071","GSM3670072","GSM3670073","GSM3670074","GSM3670075","GSM3670076","GSM3670077","GSM3670078","GSM3670079","GSM3670080","GSM3670081","GSM3670082","GSM3670083","GSM3670084","GSM3670085","GSM3670086","GSM3670087","GSM3670088","GSM3670089","GSM3670090","GSM3670091","GSM3670092","GSM3670093","GSM3670094",
"GSM3670095","GSM3670096","GSM3670097","GSM3670098","GSM3670099","GSM3670100","GSM3670104","GSM3670106","GSM3670107","GSM3670108","GSM3670109","GSM3670112","GSM3670116","GSM3670117","GSM3670118","GSM3670119","GSM3670120","GSM3670121","GSM3670124","GSM3670125","GSM3670126","GSM3670127","GSM3670128","GSM3670129","GSM3670130","GSM3670131","GSM3670132","GSM3670133","GSM3670134","GSM3670135",
"GSM3670136","GSM3670137","GSM3670138","GSM3670139","GSM3670140","GSM3670141","GSM3670142","GSM3670143","GSM3670144","GSM3670145","GSM3670146","GSM3670147","GSM3670148","GSM3670149","GSM3670150","GSM3670151","GSM3670152","GSM3670153","GSM3670154","GSM3670155","GSM3670156","GSM3670157","GSM3670158","GSM3670159","GSM3670160","GSM3670161","GSM3670162","GSM3670163","GSM3670164","GSM3670165",
"GSM3670166","GSM3670167","GSM3670168","GSM3670169","GSM3670170","GSM3670171","GSM3670172","GSM3670173","GSM3670174","GSM3670175","GSM3670176","GSM3670177","GSM3670178","GSM3670179","GSM3670180","GSM3670181","GSM3670182","GSM3670183","GSM3670184","GSM3670185","GSM3670186","GSM3670187","GSM3670188","GSM3670189","GSM3670190","GSM3670191","GSM3670192","GSM3670193","GSM3670194","GSM3670195",
"GSM3670196","GSM3670200","GSM3670202","GSM3670203","GSM3670204","GSM3670205","GSM3670206","GSM3670207","GSM3670208","GSM3670212","GSM3670213","GSM3670214","GSM3670215","GSM3670216","GSM3670217","GSM3670220","GSM3670221","GSM3670222","GSM3670223","GSM3670224","GSM3670225","GSM3670226","GSM3670227","GSM3670228","GSM3670229","GSM3670230","GSM3670231","GSM3670232","GSM3670233","GSM3670234",
"GSM3670235","GSM3670236","GSM3670237","GSM3670238","GSM3670239","GSM3670240","GSM3670241","GSM3670242","GSM3670243","GSM3670244","GSM3670245","GSM3670246","GSM3670247","GSM3670248","GSM3670249","GSM3670250","GSM3670251","GSM3670252","GSM3670253","GSM3670254","GSM3670255","GSM3670256","GSM3670257","GSM3670258","GSM3670259","GSM3670260","GSM3670261","GSM3670262","GSM3670263","GSM3670264",
"GSM3670265","GSM3670266","GSM3670267","GSM3670268","GSM3670269","GSM3670270","GSM3670271","GSM3670272","GSM3670273","GSM3670274","GSM3670275","GSM3670276","GSM3670277","GSM3670278","GSM3670279","GSM3670280","GSM3670281","GSM3670282","GSM3670283","GSM3670285","GSM3670286","GSM3670287","GSM3670288","GSM3670289","GSM3670290","GSM3670291","GSM3670292","GSM3670294","GSM3670295","GSM3670296",
"GSM3670298","GSM3670299","GSM3670300","GSM3670301","GSM3670302","GSM3670303","GSM3670304","GSM3670305","GSM3670306","GSM3670307","GSM3670308","GSM3670309","GSM3670310","GSM3670311","GSM3670312","GSM3670313","GSM3670314","GSM3670315","GSM3670316","GSM3670317","GSM3670318","GSM3670319","GSM3670320","GSM3670321","GSM3670322","GSM3670323","GSM3670324","GSM3670325","GSM3670326","GSM3670327",
"GSM3670328","GSM3670329","GSM3670330","GSM3670332","GSM3670333","GSM3670334","GSM3670335","GSM3670336","GSM3670337","GSM3670338","GSM3670339","GSM3670340","GSM3670341","GSM3670342","GSM3670343","GSM3670344","GSM3670345","GSM3670346","GSM3670347","GSM3670348","GSM3670349","GSM3670350","GSM3670351","GSM3670352","GSM3670353","GSM3670354","GSM3670355","GSM3670356","GSM3670357","GSM3670358",
"GSM3670359","GSM3670360","GSM3670361","GSM3670362","GSM3670363","GSM3670364","GSM3670365","GSM3670366","GSM3670367","GSM3670368","GSM3670369","GSM3670370","GSM3670371","GSM3670372","GSM3670373","GSM3670374","GSM3670375","GSM3670376","GSM3670377","GSM3670378","GSM3670379","GSM3670380","GSM3670381","GSM3670382","GSM3670383","GSM3670384","GSM3670385","GSM3670386","GSM3670387","GSM3670388",
"GSM3670390","GSM3670391","GSM3670392","GSM3670394","GSM3670395","GSM3670396","GSM3670397","GSM3670398","GSM3670399","GSM3670400","GSM3670401","GSM3670402","GSM3670403","GSM3670404","GSM3670405","GSM3670406","GSM3670407","GSM3670408","GSM3670409","GSM3670410","GSM3670411","GSM3670412","GSM3670413","GSM3670414","GSM3670415","GSM3670416","GSM3670417","GSM3670418","GSM3670419","GSM3670420",
"GSM3670421","GSM3670422","GSM3670423","GSM3670425","GSM3670427","GSM3670429","GSM3670431","GSM3515528","GSM3515529","GSM3515531","GSM3515532","GSM3515534","GSM3515535","GSM3515536","GSM3515537","GSM3515538","GSM3515540","GSM3515541","GSM3515542","GSM3515543","GSM3515544","GSM3515545","GSM3515548","GSM3515549","GSM3515550","GSM3515551","GSM3515553","GSM3515555","GSM3515557","GSM3515558",
"GSM3515559","GSM3515560","GSM3515561","GSM3515562","GSM3515563","GSM3515565","GSM3515566","GSM3515568","GSM3515569","GSM3515571","GSM3515572","GSM3515573","GSM3515574","GSM3515576","GSM3515577","GSM3515581","GSM3515582","GSM3515583","GSM3515584","GSM3515585","GSM3515586","GSM3515587","GSM3515588","GSM3515589","GSM3515591","GSM3515592","GSM3515594","GSM3515596","GSM3515597","GSM3515599",
"GSM3515600","GSM3515601","GSM3515602","GSM3515603","GSM3515604","GSM3515605","GSM3515606","GSM3515607","GSM3515608","GSM3515609","GSM3515610","GSM3515611","GSM3515613","GSM3515614","GSM3515616","GSM3515617","GSM3515618","GSM3515619","GSM3515620","GSM3515622","GSM3515623","GSM3573916","GSM3573917","GSM3573918","GSM3573919","GSM3573920","GSM3573948","GSM3573949","GSM3573950","GSM3573951",
"GSM3573952","GSM3573953","GSM3573954","GSM3573955","GSM3573965","GSM3573966","GSM3573967","GSM3573977","GSM3573978","GSM3633340","GSM3633341","GSM3633343","GSM3633344","GSM3633345","GSM3633346","GSM3732721","GSM3732722","GSM3732723","GSM3732727","GSM3732728","GSM3732729","GSM3732730","GSM3732731","GSM3732732","GSM4005268","GSM4005269","GSM4005270","GSM4005271","GSM4144746","GSM4144747",
"GSM4144748","GSM4144749","GSM4144750","GSM4144751","GSM4144752","GSM4144753","GSM4144754","GSM4144756","GSM4144757","GSM4144758","GSM4144759","GSM4144760","GSM4144761","GSM4144762","GSM4144763","GSM4144770","GSM4144771","GSM4144772","GSM4144773","GSM4144774","GSM4144775","GSM4251909","GSM4251910","GSM4251911","GSM4251912","GSM4251913","GSM4251914","GSM4251915","GSM4251916","GSM4251917",
"GSM4251918","GSM4251919","GSM4251920","GSM4290736","GSM4290737","GSM4290738","GSM4290739","GSM4290740","GSM4290741","GSM4290742","GSM4290743","GSM4290744","GSM4290745","GSM4290746","GSM4290747","GSM4290748","GSM4290749","GSM4290750","GSM4290751","GSM4290752","GSM4290753","GSM4290754","GSM4290755","GSM4290756","GSM4290757","GSM4290758","GSM4290759","GSM4318505","GSM4318506","GSM4318507",
"GSM4318508","GSM4318509","GSM4318510","GSM4332953","GSM4332954","GSM4332955","GSM4332956","GSM4332957","GSM4332958","GSM4476233","GSM4476234","GSM4476235","GSM4476236","GSM4476238","GSM4483270","GSM4483271","GSM4483272","GSM4506053","GSM4506054","GSM4506055","GSM4506056","GSM4506057","GSM4506058","GSM4780560","GSM4780561","GSM4780562","GSM4780563","GSM4780564","GSM4780565","GSM4780566",
"GSM4780567","GSM4780568","GSM4780569","GSM4780570","GSM4780571","GSM4780572","GSM4780573","GSM4780574","GSM4780575","GSM4780576","GSM4780577","GSM4780578","GSM4780579","GSM4780580","GSM4780581","GSM4780582","GSM4780583","GSM4780584","GSM4780585","GSM4780586","GSM4780587","GSM4780588","GSM4780589","GSM4780590","GSM4780591","GSM4780592","GSM4780593","GSM4780594","GSM4780595","GSM4780596",
"GSM4780597","GSM4780598","GSM4780599","GSM4780600","GSM4780601","GSM4780602","GSM4780603","GSM4780605","GSM4780607","GSM4780609","GSM4780610","GSM2830465","GSM2830466","GSM2830467","GSM2830468","GSM2830469","GSM2830470","GSM2830471","GSM2830472","GSM2830473","GSM2830474","GSM2830475","GSM2830476","GSM2830477","GSM2830478","GSM2830479","GSM2830480","GSM2830481","GSM3612026","GSM3612027",
"GSM3612028","GSM3612029","GSM3612030","GSM3612031","GSM3612035","GSM3612036","GSM3612037","GSM3612038","GSM3612039","GSM3612040","GSM3612041","GSM3612042","GSM3612043","GSM3612044","GSM3612045","GSM3612046","GSM3633339","GSM3633347","GSM4048701","GSM4048702","GSM4048703","GSM4048704","GSM4476237","GSM4586048","GSM4586049","GSM4586050","GSM4586051","GSM4586052","GSM4586053","GSM4586054",
"GSM4586055","GSM4586056","GSM4586057","GSM4586058","GSM4586059","GSM4586060","GSM4586061","GSM4586062","GSM4586063","GSM4586064","GSM4586066","GSM4586067","GSM4586068","GSM4586069","GSM4586071","GSM4879725","GSM4879726","GSM4879727","GSM4879728","GSM4879729","GSM4879730","GSM4879731","GSM4879732","GSM4879733","GSM4879734","GSM4879735","GSM4879736","GSM4879737","GSM4879738","GSM4879739",
"GSM4879740","GSM4879741","GSM4879742","GSM4879743","GSM4879744","GSM4879745","GSM4879746","GSM4879747","GSM4879748","GSM4879749","GSM4879750","GSM4879751","GSM4879752","GSM4879753","GSM4879754","GSM3374616","GSM3374617","GSM3374619","GSM3669875","GSM4117452","GSM4117454","GSM4138602","GSM4368335","GSM4368337","GSM4368341","GSM4368343","GSM4473116","GSM4473121","GSM4473122","GSM4473132",
"GSM4503858","GSM4503861","GSM4503862","GSM4911969","GSM4911970","GSM4911971","GSM4911973","GSM4911974","GSM4911975","GSM4911976","GSM4911977","GSM4911978","GSM4911980","GSM4987487","GSM5001896","GSM5001897","GSM5001898","GSM5024535","GSM5348188","GSM5348192","GSM5348195","GSM5453784","GSM5453792","GSM5453800","GSM5453808","GSM5453816","GSM5453824","GSM5453880","GSM5453888","GSM5453896",
"GSM5453904","GSM5453912","GSM5453920","GSM5453976","GSM5453977","GSM5453978","GSM5453984","GSM5453985","GSM5453986","GSM5453992","GSM5453993","GSM5453994","GSM5454000","GSM5454001","GSM5454002","GSM5454008","GSM5454009","GSM5454010","GSM5454016","GSM5454017","GSM5454018","GSM5454024","GSM5454025","GSM5454032","GSM5454033","GSM5454040","GSM5454041","GSM5454048","GSM5454049","GSM5454056",
"GSM5454057","GSM5454064","GSM5454065","GSM5454072","GSM5454073","GSM5454074","GSM5454080","GSM5454081","GSM5454082","GSM5454088","GSM5454089","GSM5454090","GSM5454096","GSM5454097","GSM5454098","GSM5454104","GSM5454105","GSM5454106","GSM5454112","GSM5454113","GSM5454114","GSM5454120","GSM5454121","GSM5454128","GSM5454129","GSM5454136","GSM5454137","GSM5454144","GSM5454145","GSM5454152",
"GSM5454153","GSM5454160","GSM5454161","GSM5454168","GSM5454169","GSM5454170","GSM5454176","GSM5454177","GSM5454178","GSM5454184","GSM5454185","GSM5454186","GSM5454192","GSM5454193","GSM5454194","GSM5454200","GSM5454201","GSM5454202","GSM5454208","GSM5454209","GSM5454210","GSM5454216","GSM5454217","GSM5454224","GSM5454225","GSM5454232","GSM5454233","GSM5454240","GSM5454241","GSM5454248",
"GSM5454249","GSM5454256","GSM5454257","GSM5534218","GSM5534219","GSM5534220","GSM5534221","GSM5534222","GSM5534223","GSM5534224","GSM5534225","GSM5534226","GSM5534227","GSM5534229","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/samples/geo_accession")
genes = h5read(destination_file, "meta/genes/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = t(h5read(destination_file, "data/expression", index=list(sample_locations, 1:length(genes))))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE, col.names=NA)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))

